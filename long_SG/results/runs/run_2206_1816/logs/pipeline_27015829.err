+ ROOT_DIR=/scratch/prj/aef_forensic_metagenomics
+ echo -e '\n================================================= ARGUMENT PARSING & VALIDATION =================================================\n'
+ TRIM=false
+ REMOVE_HOST_DNA=false
+ GT_FLAG=false
+ DATABASE=/scratch/prj/aef_forensic_metagenomics/data/databases/k2_standard_16gb_20250402
+ BOWTIE_PREFIX=/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as
+ ADAPTER_FILE=/scratch/prj/aef_forensic_metagenomics/data/adapters/TruSeq3-PE-2.fa
+ B_THRESHOLD=0
+ K2_MIN_HIT=2
+ [[ 9 -eq 0 ]]
+ [[ 9 -gt 0 ]]
+ case "$1" in
+ [[ -z ../long_SG/raw_data/ ]]
+ [[ ../long_SG/raw_data/ == -* ]]
+ [[ ! -d ../long_SG/raw_data/ ]]
++ find ../long_SG/raw_data/ -maxdepth 1 -type f '(' -name '*.fq' -o -name '*.fastq' -o -name '*.fq.gz' -o -name '*.fastq.gz' ')'
+ [[ -z ../long_SG/raw_data/C12_S36_L001_R2_001.fastq.gz
../long_SG/raw_data/B10_S22_L001_R2_001.fastq.gz
../long_SG/raw_data/C08_S32_L001_R2_001.fastq.gz
../long_SG/raw_data/B01_S13_L001_R2_001.fastq.gz
../long_SG/raw_data/C02_S26_L001_R2_001.fastq.gz
../long_SG/raw_data/A06_S6_L001_R2_001.fastq.gz
../long_SG/raw_data/A05_S5_L001_R1_001.fastq.gz
../long_SG/raw_data/B03_S15_L001_R2_001.fastq.gz
../long_SG/raw_data/A09_S9_L001_R1_001.fastq.gz
../long_SG/raw_data/B11_S23_L001_R2_001.fastq.gz
../long_SG/raw_data/B07_S19_L001_R2_001.fastq.gz
../long_SG/raw_data/A02_S2_L001_R2_001.fastq.gz
../long_SG/raw_data/B08_S20_L001_R2_001.fastq.gz
../long_SG/raw_data/B09_S21_L001_R1_001.fastq.gz
../long_SG/raw_data/A10_S10_L001_R2_001.fastq.gz
../long_SG/raw_data/C06_S30_L001_R1_001.fastq.gz
../long_SG/raw_data/B03_S15_L001_R1_001.fastq.gz
../long_SG/raw_data/C05_S29_L001_R1_001.fastq.gz
../long_SG/raw_data/C11_S35_L001_R1_001.fastq.gz
../long_SG/raw_data/C01_S25_L001_R2_001.fastq.gz
../long_SG/raw_data/C11_S35_L001_R2_001.fastq.gz
../long_SG/raw_data/A12_S12_L001_R2_001.fastq.gz
../long_SG/raw_data/A01_S1_L001_R2_001.fastq.gz
../long_SG/raw_data/A03_S3_L001_R2_001.fastq.gz
../long_SG/raw_data/C09_S33_L001_R1_001.fastq.gz
../long_SG/raw_data/B04_S16_L001_R1_001.fastq.gz
../long_SG/raw_data/A07_S7_L001_R2_001.fastq.gz
../long_SG/raw_data/B01_S13_L001_R1_001.fastq.gz
../long_SG/raw_data/B09_S21_L001_R2_001.fastq.gz
../long_SG/raw_data/A11_S11_L001_R1_001.fastq.gz
../long_SG/raw_data/C05_S29_L001_R2_001.fastq.gz
../long_SG/raw_data/C08_S32_L001_R1_001.fastq.gz
../long_SG/raw_data/ENC_S37_L001_R2_001.fastq.gz
../long_SG/raw_data/B06_S18_L001_R1_001.fastq.gz
../long_SG/raw_data/B11_S23_L001_R1_001.fastq.gz
../long_SG/raw_data/B12_S24_L001_R1_001.fastq.gz
../long_SG/raw_data/B12_S24_L001_R2_001.fastq.gz
../long_SG/raw_data/Blank_S38_L001_R2_001.fastq.gz
../long_SG/raw_data/B07_S19_L001_R1_001.fastq.gz
../long_SG/raw_data/B10_S22_L001_R1_001.fastq.gz
../long_SG/raw_data/C02_S26_L001_R1_001.fastq.gz
../long_SG/raw_data/A02_S2_L001_R1_001.fastq.gz
../long_SG/raw_data/A08_S8_L001_R2_001.fastq.gz
../long_SG/raw_data/Blank_S38_L001_R1_001.fastq.gz
../long_SG/raw_data/B05_S17_L001_R1_001.fastq.gz
../long_SG/raw_data/A03_S3_L001_R1_001.fastq.gz
../long_SG/raw_data/C07_S31_L001_R2_001.fastq.gz
../long_SG/raw_data/C10_S34_L001_R2_001.fastq.gz
../long_SG/raw_data/A12_S12_L001_R1_001.fastq.gz
../long_SG/raw_data/B04_S16_L001_R2_001.fastq.gz
../long_SG/raw_data/C10_S34_L001_R1_001.fastq.gz
../long_SG/raw_data/B02_S14_L001_R2_001.fastq.gz
../long_SG/raw_data/A11_S11_L001_R2_001.fastq.gz
../long_SG/raw_data/C09_S33_L001_R2_001.fastq.gz
../long_SG/raw_data/C07_S31_L001_R1_001.fastq.gz
../long_SG/raw_data/C03_S27_L001_R1_001.fastq.gz
../long_SG/raw_data/A05_S5_L001_R2_001.fastq.gz
../long_SG/raw_data/A01_S1_L001_R1_001.fastq.gz
../long_SG/raw_data/A07_S7_L001_R1_001.fastq.gz
../long_SG/raw_data/B08_S20_L001_R1_001.fastq.gz
../long_SG/raw_data/B06_S18_L001_R2_001.fastq.gz
../long_SG/raw_data/B02_S14_L001_R1_001.fastq.gz
../long_SG/raw_data/C03_S27_L001_R2_001.fastq.gz
../long_SG/raw_data/ENC_S37_L001_R1_001.fastq.gz
../long_SG/raw_data/B05_S17_L001_R2_001.fastq.gz
../long_SG/raw_data/A06_S6_L001_R1_001.fastq.gz
../long_SG/raw_data/C04_S28_L001_R2_001.fastq.gz
../long_SG/raw_data/C06_S30_L001_R2_001.fastq.gz
../long_SG/raw_data/C04_S28_L001_R1_001.fastq.gz
../long_SG/raw_data/A04_S4_L001_R1_001.fastq.gz
../long_SG/raw_data/C01_S25_L001_R1_001.fastq.gz
../long_SG/raw_data/A10_S10_L001_R1_001.fastq.gz
../long_SG/raw_data/C12_S36_L001_R1_001.fastq.gz
../long_SG/raw_data/A09_S9_L001_R2_001.fastq.gz
../long_SG/raw_data/A04_S4_L001_R2_001.fastq.gz
../long_SG/raw_data/A08_S8_L001_R1_001.fastq.gz ]]
+ for file in "$2"/*.{fq,fastq}
+ [[ -f ../long_SG/raw_data//*.fq ]]
+ for file in "$2"/*.{fq,fastq}
+ [[ -f ../long_SG/raw_data//*.fastq ]]
+ for file in "$2"/*.fq.gz
+ [[ -f ../long_SG/raw_data//*.fq.gz ]]
+ RAW_FASTQ_DIR=../long_SG/raw_data/
++ dirname ../long_SG/raw_data/
+ PROJ_DIR=../long_SG
+ shift 2
+ [[ 7 -gt 0 ]]
+ case "$1" in
+ [[ -z ../data/databases/k2_pluspfp_20250402/ ]]
+ [[ ../data/databases/k2_pluspfp_20250402/ == -* ]]
+ [[ ! -d ../data/databases/k2_pluspfp_20250402/ ]]
+ [[ ! -f ../data/databases/k2_pluspfp_20250402//hash.k2d ]]
+ [[ ! -f ../data/databases/k2_pluspfp_20250402//taxo.k2d ]]
+ [[ ! -f ../data/databases/k2_pluspfp_20250402//opts.k2d ]]
+ compgen -G ../data/databases/k2_pluspfp_20250402//database100mers.kmer_distrib ../data/databases/k2_pluspfp_20250402//database150mers.kmer_distrib ../data/databases/k2_pluspfp_20250402//database200mers.kmer_distrib ../data/databases/k2_pluspfp_20250402//database250mers.kmer_distrib ../data/databases/k2_pluspfp_20250402//database300mers.kmer_distrib ../data/databases/k2_pluspfp_20250402//database50mers.kmer_distrib ../data/databases/k2_pluspfp_20250402//database75mers.kmer_distrib
+ DATABASE=../data/databases/k2_pluspfp_20250402/
+ shift 2
+ [[ 5 -gt 0 ]]
+ case "$1" in
+ REMOVE_HOST_DNA=true
+ [[ -z --k2-min-hit ]]
+ [[ --k2-min-hit == -* ]]
+ echo '⚠️  No Bowtie2 index provided. Using default.'
+ shift
+ [[ 4 -gt 0 ]]
+ case "$1" in
+ [[ -z 3 ]]
+ [[ 3 == -* ]]
+ K2_MIN_HIT=3
+ shift 2
+ [[ 2 -gt 0 ]]
+ case "$1" in
+ [[ -z 40 ]]
+ [[ 40 == -* ]]
+ B_THRESHOLD=40
+ shift 2
+ [[ 0 -gt 0 ]]
+ [[ -z ../long_SG/raw_data/ ]]
+ [[ false == false ]]
+ echo '⚠️  Trimming and host DNA removal are optional but must be done once; if skipped, ensure trimmed and filtered files exist in the correct directories.\n'
+ echo '===== Pipeline Configuration Summary ====='
+ echo 'Raw FASTQ directory path: ../long_SG/raw_data/'
+ echo 'Kraken2/Bracken Database: ../data/databases/k2_pluspfp_20250402/'
++ [[ false == true ]]
++ echo 'Not provided ❌'
+ echo 'Ground Truth: Not provided ❌'
++ [[ false == true ]]
++ echo 'Disabled ❌'
+ echo 'Quality Control & Trimming: Disabled ❌'
++ [[ true == true ]]
++ echo 'Enabled ✅ (Index: /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as)'
+ echo 'Host DNA Removal: Enabled ✅ (Index: /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as)'
+ echo -e '\n================================================= CONDA ENVIRONMENT ACTIVATION ==================================================\n'
+ source /scratch/prj/aef_forensic_metagenomics/scripts/helper_scripts/environment_setup.sh /scratch/prj/aef_forensic_metagenomics/scripts/metagenomics.yml
++ [[ -z /scratch/prj/aef_forensic_metagenomics/scripts/metagenomics.yml ]]
++ [[ /scratch/prj/aef_forensic_metagenomics/scripts/metagenomics.yml != *.yml ]]
++ [[ ! -f /scratch/prj/aef_forensic_metagenomics/scripts/metagenomics.yml ]]
++ ENV_FILE=/scratch/prj/aef_forensic_metagenomics/scripts/metagenomics.yml
+++ basename /scratch/prj/aef_forensic_metagenomics/scripts/metagenomics.yml .yml
++ ENV_NAME=metagenomics
++ command -v conda
+++ conda shell.bash hook
++ eval 'export CONDA_EXE='\''/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin/python'\''

# Copyright (C) 2012 Anaconda, Inc
# SPDX-License-Identifier: BSD-3-Clause

__conda_exe() (
    "$CONDA_EXE" $_CE_M $_CE_CONDA "$@"
)

__conda_hashr() {
    if [ -n "${ZSH_VERSION:+x}" ]; then
        \rehash
    elif [ -n "${POSH_VERSION:+x}" ]; then
        :  # pass
    else
        \hash -r
    fi
}

__conda_activate() {
    if [ -n "${CONDA_PS1_BACKUP:+x}" ]; then
        # Handle transition from shell activated with conda <= 4.3 to a subsequent activation
        # after conda updated to >= 4.4. See issue #6173.
        PS1="$CONDA_PS1_BACKUP"
        \unset CONDA_PS1_BACKUP
    fi
    \local ask_conda
    ask_conda="$(PS1="${PS1:-}" __conda_exe shell.posix "$@")" || \return
    \eval "$ask_conda"
    __conda_hashr
}

__conda_reactivate() {
    \local ask_conda
    ask_conda="$(PS1="${PS1:-}" __conda_exe shell.posix reactivate)" || \return
    \eval "$ask_conda"
    __conda_hashr
}

conda() {
    \local cmd="${1-__missing__}"
    case "$cmd" in
        activate|deactivate)
            __conda_activate "$@"
            ;;
        install|update|upgrade|remove|uninstall)
            __conda_exe "$@" || \return
            __conda_reactivate
            ;;
        *)
            __conda_exe "$@"
            ;;
    esac
}

if [ -z "${CONDA_SHLVL+x}" ]; then
    \export CONDA_SHLVL=0
    # In dev-mode CONDA_EXE is python.exe and on Windows
    # it is in a different relative location to condabin.
    if [ -n "${_CE_CONDA:+x}" ] && [ -n "${WINDIR+x}" ]; then
        PATH="$(\dirname "$CONDA_EXE")/condabin${PATH:+":${PATH}"}"
    else
        PATH="$(\dirname "$(\dirname "$CONDA_EXE")")/condabin${PATH:+":${PATH}"}"
    fi
    \export PATH

    # We'\''re not allowing PS1 to be unbound. It must at least be set.
    # However, we'\''re not exporting it, which can cause problems when starting a second shell
    # via a first shell (i.e. starting zsh from bash).
    if [ -z "${PS1+x}" ]; then
        PS1=
    fi
fi

conda activate base'
+++ export CONDA_EXE=/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin/conda
+++ CONDA_EXE=/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin/python
+++ CONDA_PYTHON_EXE=/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin/python
+++ '[' -z x ']'
+++ conda activate base
+++ local cmd=activate
+++ case "$cmd" in
+++ __conda_activate activate base
+++ '[' -n '' ']'
+++ local ask_conda
++++ PS1=
++++ __conda_exe shell.posix activate base
++++ /software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin/conda shell.posix activate base
+++ ask_conda='. "/users/k24087895/.conda/envs/metagenomics/etc/conda/deactivate.d/openjdk_deactivate.sh"
. "/users/k24087895/.conda/envs/metagenomics/etc/conda/deactivate.d/libxml2_deactivate.sh"
. "/users/k24087895/.conda/envs/metagenomics/etc/conda/deactivate.d/libglib_deactivate.sh"
. "/users/k24087895/.conda/envs/metagenomics/etc/conda/deactivate.d/deactivate-r-base.sh"
PS1='\''(base) '\''
export PATH='\''/users/k24087895/.local/bin:/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin:/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/opt/puppetlabs/bin'\''
export CONDA_PREFIX='\''/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe'\''
export CONDA_SHLVL='\''5'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_PREFIX_4='\''/users/k24087895/.conda/envs/metagenomics'\''
export CONDA_EXE='\''/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin/python'\'''
+++ eval '. "/users/k24087895/.conda/envs/metagenomics/etc/conda/deactivate.d/openjdk_deactivate.sh"
. "/users/k24087895/.conda/envs/metagenomics/etc/conda/deactivate.d/libxml2_deactivate.sh"
. "/users/k24087895/.conda/envs/metagenomics/etc/conda/deactivate.d/libglib_deactivate.sh"
. "/users/k24087895/.conda/envs/metagenomics/etc/conda/deactivate.d/deactivate-r-base.sh"
PS1='\''(base) '\''
export PATH='\''/users/k24087895/.local/bin:/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin:/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/opt/puppetlabs/bin'\''
export CONDA_PREFIX='\''/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe'\''
export CONDA_SHLVL='\''5'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_PREFIX_4='\''/users/k24087895/.conda/envs/metagenomics'\''
export CONDA_EXE='\''/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin/python'\'''
++++ . /users/k24087895/.conda/envs/metagenomics/etc/conda/deactivate.d/openjdk_deactivate.sh
+++++ '[' x ']'
+++++ export JAVA_HOME=/users/k24087895/.conda/envs/metagenomics/lib/jvm
+++++ JAVA_HOME=/users/k24087895/.conda/envs/metagenomics/lib/jvm
+++++ unset JAVA_HOME_CONDA_BACKUP
+++++ '[' x ']'
+++++ export JAVA_LD_LIBRARY_PATH=/users/k24087895/.conda/envs/metagenomics/lib/jvm/lib/server
+++++ JAVA_LD_LIBRARY_PATH=/users/k24087895/.conda/envs/metagenomics/lib/jvm/lib/server
+++++ unset JAVA_LD_LIBRARY_PATH_BACKUP
++++ . /users/k24087895/.conda/envs/metagenomics/etc/conda/deactivate.d/libxml2_deactivate.sh
+++++ test -n ''
+++++ unset XML_CATALOG_FILES
+++++ unset xml_catalog_files_libxml2
++++ . /users/k24087895/.conda/envs/metagenomics/etc/conda/deactivate.d/libglib_deactivate.sh
+++++ export GSETTINGS_SCHEMA_DIR=
+++++ GSETTINGS_SCHEMA_DIR=
+++++ unset GSETTINGS_SCHEMA_DIR_CONDA_BACKUP
+++++ '[' -z ']'
+++++ unset GSETTINGS_SCHEMA_DIR
++++ . /users/k24087895/.conda/envs/metagenomics/etc/conda/deactivate.d/deactivate-r-base.sh
+++++ '[' -n '' ']'
+++++ unset RSTUDIO_WHICH_R
++++ PS1='(base) '
++++ export PATH=/users/k24087895/.local/bin:/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin:/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/opt/puppetlabs/bin
++++ PATH=/users/k24087895/.local/bin:/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin:/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/opt/puppetlabs/bin
++++ export CONDA_PREFIX=/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe
++++ CONDA_PREFIX=/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe
++++ export CONDA_SHLVL=5
++++ CONDA_SHLVL=5
++++ export CONDA_DEFAULT_ENV=base
++++ CONDA_DEFAULT_ENV=base
++++ export 'CONDA_PROMPT_MODIFIER=(base) '
++++ CONDA_PROMPT_MODIFIER='(base) '
++++ export CONDA_PREFIX_4=/users/k24087895/.conda/envs/metagenomics
++++ CONDA_PREFIX_4=/users/k24087895/.conda/envs/metagenomics
++++ export CONDA_EXE=/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin/conda
++++ CONDA_EXE=/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin/conda
++++ export _CE_M=
++++ _CE_M=
++++ export _CE_CONDA=
++++ _CE_CONDA=
++++ export CONDA_PYTHON_EXE=/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin/python
++++ CONDA_PYTHON_EXE=/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin/python
+++ __conda_hashr
+++ '[' -n '' ']'
+++ '[' -n '' ']'
+++ hash -r
++ conda env list
++ local cmd=env
++ case "$cmd" in
++ __conda_exe env list
++ grep -q metagenomics
++ /software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin/conda env list
++ conda activate metagenomics
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate metagenomics
++ '[' -n '' ']'
++ local ask_conda
+++ PS1='(base) '
+++ __conda_exe shell.posix activate metagenomics
+++ /software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin/conda shell.posix activate metagenomics
++ ask_conda='PS1='\''(metagenomics) '\''
export PATH='\''/users/k24087895/.local/bin:/users/k24087895/.conda/envs/metagenomics/bin:/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/opt/puppetlabs/bin'\''
export CONDA_PREFIX='\''/users/k24087895/.conda/envs/metagenomics'\''
export CONDA_SHLVL='\''6'\''
export CONDA_DEFAULT_ENV='\''metagenomics'\''
export CONDA_PROMPT_MODIFIER='\''(metagenomics) '\''
export CONDA_PREFIX_5='\''/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe'\''
export CONDA_EXE='\''/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin/python'\''
. "/users/k24087895/.conda/envs/metagenomics/etc/conda/activate.d/activate-r-base.sh"
. "/users/k24087895/.conda/envs/metagenomics/etc/conda/activate.d/libglib_activate.sh"
. "/users/k24087895/.conda/envs/metagenomics/etc/conda/activate.d/libxml2_activate.sh"
. "/users/k24087895/.conda/envs/metagenomics/etc/conda/activate.d/openjdk_activate.sh"'
++ eval 'PS1='\''(metagenomics) '\''
export PATH='\''/users/k24087895/.local/bin:/users/k24087895/.conda/envs/metagenomics/bin:/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/opt/puppetlabs/bin'\''
export CONDA_PREFIX='\''/users/k24087895/.conda/envs/metagenomics'\''
export CONDA_SHLVL='\''6'\''
export CONDA_DEFAULT_ENV='\''metagenomics'\''
export CONDA_PROMPT_MODIFIER='\''(metagenomics) '\''
export CONDA_PREFIX_5='\''/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe'\''
export CONDA_EXE='\''/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin/python'\''
. "/users/k24087895/.conda/envs/metagenomics/etc/conda/activate.d/activate-r-base.sh"
. "/users/k24087895/.conda/envs/metagenomics/etc/conda/activate.d/libglib_activate.sh"
. "/users/k24087895/.conda/envs/metagenomics/etc/conda/activate.d/libxml2_activate.sh"
. "/users/k24087895/.conda/envs/metagenomics/etc/conda/activate.d/openjdk_activate.sh"'
+++ PS1='(metagenomics) '
+++ export PATH=/users/k24087895/.local/bin:/users/k24087895/.conda/envs/metagenomics/bin:/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/opt/puppetlabs/bin
+++ PATH=/users/k24087895/.local/bin:/users/k24087895/.conda/envs/metagenomics/bin:/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/opt/puppetlabs/bin
+++ export CONDA_PREFIX=/users/k24087895/.conda/envs/metagenomics
+++ CONDA_PREFIX=/users/k24087895/.conda/envs/metagenomics
+++ export CONDA_SHLVL=6
+++ CONDA_SHLVL=6
+++ export CONDA_DEFAULT_ENV=metagenomics
+++ CONDA_DEFAULT_ENV=metagenomics
+++ export 'CONDA_PROMPT_MODIFIER=(metagenomics) '
+++ CONDA_PROMPT_MODIFIER='(metagenomics) '
+++ export CONDA_PREFIX_5=/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe
+++ CONDA_PREFIX_5=/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe
+++ export CONDA_EXE=/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin/conda
+++ CONDA_EXE=/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin/python
+++ CONDA_PYTHON_EXE=/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/bin/python
+++ . /users/k24087895/.conda/envs/metagenomics/etc/conda/activate.d/activate-r-base.sh
++++ R CMD javareconf
++++ '[' -n '' ']'
++++ export RSTUDIO_WHICH_R=/users/k24087895/.conda/envs/metagenomics/bin/R
++++ RSTUDIO_WHICH_R=/users/k24087895/.conda/envs/metagenomics/bin/R
+++ . /users/k24087895/.conda/envs/metagenomics/etc/conda/activate.d/libglib_activate.sh
++++ export GSETTINGS_SCHEMA_DIR_CONDA_BACKUP=
++++ GSETTINGS_SCHEMA_DIR_CONDA_BACKUP=
++++ export GSETTINGS_SCHEMA_DIR=/users/k24087895/.conda/envs/metagenomics/share/glib-2.0/schemas
++++ GSETTINGS_SCHEMA_DIR=/users/k24087895/.conda/envs/metagenomics/share/glib-2.0/schemas
+++ . /users/k24087895/.conda/envs/metagenomics/etc/conda/activate.d/libxml2_activate.sh
++++ test -n ''
++++ xml_catalog_files_libxml2=
++++ XML_CATALOG_FILES=
++++ conda_catalog_files=
++++ ifs_libxml2=' 	
'
++++ IFS=' '
++++ rem=/users/k24087895/.conda/envs/metagenomics
++++ for pre in ${rem}
++++ test '' = /users/k24087895/.conda/envs/metagenomics
++++ conda_catalog_files=/users/k24087895/.conda/envs/metagenomics
++++ rem=
++++ IFS=' 	
'
++++ conda_catalog_files='file:///users/k24087895/.conda/envs/metagenomics/etc/xml/catalog file:///etc/xml/catalog'
++++ export 'XML_CATALOG_FILES=file:///users/k24087895/.conda/envs/metagenomics/etc/xml/catalog file:///etc/xml/catalog'
++++ XML_CATALOG_FILES='file:///users/k24087895/.conda/envs/metagenomics/etc/xml/catalog file:///etc/xml/catalog'
++++ unset conda_catalog_files ifs_libxml2 rem
+++ . /users/k24087895/.conda/envs/metagenomics/etc/conda/activate.d/openjdk_activate.sh
++++ '[' x ']'
++++ export JAVA_HOME_CONDA_BACKUP=/users/k24087895/.conda/envs/metagenomics/lib/jvm
++++ JAVA_HOME_CONDA_BACKUP=/users/k24087895/.conda/envs/metagenomics/lib/jvm
++++ export JAVA_HOME=/users/k24087895/.conda/envs/metagenomics/lib/jvm
++++ JAVA_HOME=/users/k24087895/.conda/envs/metagenomics/lib/jvm
++++ '[' x ']'
++++ export JAVA_LD_LIBRARY_PATH_BACKUP=/users/k24087895/.conda/envs/metagenomics/lib/jvm/lib/server
++++ JAVA_LD_LIBRARY_PATH_BACKUP=/users/k24087895/.conda/envs/metagenomics/lib/jvm/lib/server
++++ export JAVA_LD_LIBRARY_PATH=/users/k24087895/.conda/envs/metagenomics/lib/jvm/lib/server
++++ JAVA_LD_LIBRARY_PATH=/users/k24087895/.conda/envs/metagenomics/lib/jvm/lib/server
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
++ echo '✅ '\''metagenomics'\'' environment activated successfully.'
++ export PATH=/users/k24087895/.conda/envs/metagenomics/bin:/users/k24087895/.local/bin:/users/k24087895/.conda/envs/metagenomics/bin:/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/opt/puppetlabs/bin
++ PATH=/users/k24087895/.conda/envs/metagenomics/bin:/users/k24087895/.local/bin:/users/k24087895/.conda/envs/metagenomics/bin:/software/spackages_v0_21_prod/apps/linux-ubuntu22.04-zen2/gcc-13.2.0/anaconda3-2022.10-5wy43yh5crcsmws4afls5thwoskzarhe/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/opt/puppetlabs/bin
+++ python -c 'import sys; print(".".join(map(str, sys.version_info[:3])))'
++ export PYTHONPATH=/users/k24087895/.conda/envs/metagenomics/lib/python3.12.10/site-packages:
++ PYTHONPATH=/users/k24087895/.conda/envs/metagenomics/lib/python3.12.10/site-packages:
+ echo -e '\n====================================================== PROJECT STRUCTURE ======================================================\n'
+ RESULTS_DIR=../long_SG/results
+ HOST_DNA_ANALYSIS_DIR=../long_SG/results/host_dna_analysis
++ dirname ../long_SG/raw_data/
+ PROCESSED_DIR=../long_SG/processed_data
+ TRIMMED_DIR=../long_SG/processed_data/trimmed
+ HUMAN_DIR=../long_SG/processed_data/human
+ ALIGNED_SAM_DIR=../long_SG/processed_data/human/aligned_sam
+ SORTED_BAM_DIR=../long_SG/processed_data/human/sorted_bam
+ BED_FILES_DIR=../long_SG/processed_data/human/bed_files
+ METAGENOMIC_DIR=../long_SG/processed_data/metagenomic
+ FILTERED_FASTQ_DIR=../long_SG/processed_data/metagenomic/filtered_fastq
+ KRAKEN2_DIR=../long_SG/processed_data/metagenomic/kraken2
+ CLASSIFIED_DIR=../long_SG/processed_data/metagenomic/classified
+ UNCLASSIFIED_DIR=../long_SG/processed_data/metagenomic/unclassified
+ BRACKEN_DIR=../long_SG/processed_data/metagenomic/bracken
++ date +run_%d%m_%H%M
+ RUN_DIR=../long_SG/results/runs/run_2206_1816
+ REPORTS_DIR=../long_SG/results/runs/run_2206_1816/reports
+ KRONA_DIR=../long_SG/results/runs/run_2206_1816/krona
+ DIVERSITY_DIR=../long_SG/results/runs/run_2206_1816/diversity
+ LOG_DIR=../long_SG/results/runs/run_2206_1816/logs
+ mkdir -p ../long_SG/results ../long_SG/results/host_dna_analysis ../long_SG/processed_data/trimmed/paired ../long_SG/processed_data/trimmed/unpaired ../long_SG/processed_data/human/aligned_sam ../long_SG/processed_data/metagenomic/filtered_fastq ../long_SG/processed_data/metagenomic/kraken2 ../long_SG/processed_data/metagenomic/classified ../long_SG/processed_data/metagenomic/unclassified ../long_SG/processed_data/metagenomic/bracken ../long_SG/results/runs/run_2206_1816/reports ../long_SG/results/runs/run_2206_1816/krona ../long_SG/results/runs/run_2206_1816/diversity ../long_SG/results/runs/run_2206_1816/logs ../long_SG/processed_data/human/sorted_bam ../long_SG/processed_data/human/bed_files
+ tree -L 3 -d ../long_SG
+ echo 'Human DNA-related files (SAM, BAM, and BED) in the '\''human'\'' directory are created once per sub-project and remain unchanged across runs.'
+ echo 'Intermediate metagenomic files in the '\''metagenomic'\'' directory are overwritten with each run and should be inspected beforehand if desired.'
+ echo 'Results are stored in the '\''results'\'' directory (including FastQC, host DNA analysis, and run-specific results like Kraken2 and Bracken).'
+ [[ false == true ]]
+ echo -e '\n================================================= METAGENOMIC ABUNDANCE ESTIMATION ================================================='
+ echo '⚠️  This step assumes reads have already been trimmed with Trimmomatic and host DNA removed with Bowtie2. Processed reads must be in the correct directory.'
++ date +%s
+ START_TIME=1750612595
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/A01_S1_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=A01_S1
+ echo -e '\nProcessing sample: A01_S1'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A01_S1_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A01_S1_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A01_S1_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A01_S1_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A01_S1_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A01_S1_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A01_S1_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A01_S1_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A01_S1_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A01_S1_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A01_S1_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A01_S1_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/A01_S1_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/A01_S1_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/A01_S1_metagenomic -S ../long_SG/processed_data/human/aligned_sam/A01_S1_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/A01_S1_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/A01_S1_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A01_S1.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A01_S1_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A01_S1_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A01_S1.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A01_S1_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A01_S1_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A01_S1.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A01_S1_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A01_S1_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A01_S1.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A01_S1_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A01_S1_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A01_S1.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A01_S1_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A01_S1_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A01_S1.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A01_S1_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A01_S1_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/A01_S1.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/A01_S1_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/A01_S1_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/A01_S1.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/A01_S1_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/A01_S1_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/A01_S1.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/A01_S1.breport -o ../long_SG/processed_data/metagenomic/bracken/A01_S1.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/A01_S1.breport -o ../long_SG/results/runs/run_2206_1816/krona/A01_S1.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/A01_S1.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/A01_S1.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/A01_S1.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/A02_S2_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=A02_S2
+ echo -e '\nProcessing sample: A02_S2'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A02_S2_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A02_S2_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A02_S2_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A02_S2_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A02_S2_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A02_S2_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A02_S2_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A02_S2_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A02_S2_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A02_S2_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A02_S2_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A02_S2_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/A02_S2_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/A02_S2_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/A02_S2_metagenomic -S ../long_SG/processed_data/human/aligned_sam/A02_S2_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/A02_S2_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/A02_S2_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A02_S2.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A02_S2_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A02_S2_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A02_S2.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A02_S2_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A02_S2_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A02_S2.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A02_S2_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A02_S2_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A02_S2.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A02_S2_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A02_S2_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A02_S2.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A02_S2_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A02_S2_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A02_S2.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A02_S2_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A02_S2_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/A02_S2.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/A02_S2_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/A02_S2_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/A02_S2.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/A02_S2_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/A02_S2_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/A02_S2.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/A02_S2.breport -o ../long_SG/processed_data/metagenomic/bracken/A02_S2.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/A02_S2.breport -o ../long_SG/results/runs/run_2206_1816/krona/A02_S2.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/A02_S2.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/A02_S2.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/A02_S2.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/A03_S3_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=A03_S3
+ echo -e '\nProcessing sample: A03_S3'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A03_S3_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A03_S3_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A03_S3_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A03_S3_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A03_S3_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A03_S3_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A03_S3_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A03_S3_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A03_S3_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A03_S3_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A03_S3_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A03_S3_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/A03_S3_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/A03_S3_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/A03_S3_metagenomic -S ../long_SG/processed_data/human/aligned_sam/A03_S3_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/A03_S3_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/A03_S3_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A03_S3.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A03_S3_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A03_S3_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A03_S3.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A03_S3_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A03_S3_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A03_S3.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A03_S3_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A03_S3_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A03_S3.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A03_S3_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A03_S3_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A03_S3.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A03_S3_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A03_S3_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A03_S3.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A03_S3_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A03_S3_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/A03_S3.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/A03_S3_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/A03_S3_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/A03_S3.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/A03_S3_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/A03_S3_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/A03_S3.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/A03_S3.breport -o ../long_SG/processed_data/metagenomic/bracken/A03_S3.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/A03_S3.breport -o ../long_SG/results/runs/run_2206_1816/krona/A03_S3.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/A03_S3.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/A03_S3.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/A03_S3.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/A04_S4_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=A04_S4
+ echo -e '\nProcessing sample: A04_S4'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A04_S4_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A04_S4_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A04_S4_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A04_S4_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A04_S4_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A04_S4_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A04_S4_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A04_S4_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A04_S4_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A04_S4_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A04_S4_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A04_S4_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/A04_S4_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/A04_S4_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/A04_S4_metagenomic -S ../long_SG/processed_data/human/aligned_sam/A04_S4_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/A04_S4_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/A04_S4_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A04_S4.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A04_S4_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A04_S4_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A04_S4.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A04_S4_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A04_S4_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A04_S4.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A04_S4_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A04_S4_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A04_S4.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A04_S4_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A04_S4_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A04_S4.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A04_S4_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A04_S4_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A04_S4.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A04_S4_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A04_S4_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/A04_S4.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/A04_S4_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/A04_S4_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/A04_S4.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/A04_S4_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/A04_S4_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/A04_S4.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/A04_S4.breport -o ../long_SG/processed_data/metagenomic/bracken/A04_S4.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/A04_S4.breport -o ../long_SG/results/runs/run_2206_1816/krona/A04_S4.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/A04_S4.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/A04_S4.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/A04_S4.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/A05_S5_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=A05_S5
+ echo -e '\nProcessing sample: A05_S5'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A05_S5_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A05_S5_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A05_S5_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A05_S5_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A05_S5_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A05_S5_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A05_S5_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A05_S5_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A05_S5_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A05_S5_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A05_S5_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A05_S5_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/A05_S5_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/A05_S5_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/A05_S5_metagenomic -S ../long_SG/processed_data/human/aligned_sam/A05_S5_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/A05_S5_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/A05_S5_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A05_S5.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A05_S5_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A05_S5_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A05_S5.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A05_S5_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A05_S5_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A05_S5.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A05_S5_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A05_S5_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A05_S5.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A05_S5_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A05_S5_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A05_S5.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A05_S5_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A05_S5_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A05_S5.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A05_S5_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A05_S5_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/A05_S5.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/A05_S5_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/A05_S5_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/A05_S5.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/A05_S5_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/A05_S5_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/A05_S5.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/A05_S5.breport -o ../long_SG/processed_data/metagenomic/bracken/A05_S5.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/A05_S5.breport -o ../long_SG/results/runs/run_2206_1816/krona/A05_S5.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/A05_S5.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/A05_S5.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/A05_S5.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/A06_S6_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=A06_S6
+ echo -e '\nProcessing sample: A06_S6'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A06_S6_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A06_S6_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A06_S6_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A06_S6_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A06_S6_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A06_S6_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A06_S6_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A06_S6_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A06_S6_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A06_S6_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A06_S6_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A06_S6_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/A06_S6_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/A06_S6_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/A06_S6_metagenomic -S ../long_SG/processed_data/human/aligned_sam/A06_S6_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/A06_S6_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/A06_S6_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A06_S6.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A06_S6_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A06_S6_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A06_S6.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A06_S6_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A06_S6_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A06_S6.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A06_S6_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A06_S6_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A06_S6.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A06_S6_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A06_S6_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A06_S6.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A06_S6_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A06_S6_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A06_S6.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A06_S6_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A06_S6_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/A06_S6.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/A06_S6_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/A06_S6_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/A06_S6.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/A06_S6_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/A06_S6_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/A06_S6.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/A06_S6.breport -o ../long_SG/processed_data/metagenomic/bracken/A06_S6.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/A06_S6.breport -o ../long_SG/results/runs/run_2206_1816/krona/A06_S6.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/A06_S6.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/A06_S6.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/A06_S6.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/A07_S7_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=A07_S7
+ echo -e '\nProcessing sample: A07_S7'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A07_S7_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A07_S7_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A07_S7_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A07_S7_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A07_S7_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A07_S7_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A07_S7_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A07_S7_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A07_S7_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A07_S7_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A07_S7_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A07_S7_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/A07_S7_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/A07_S7_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/A07_S7_metagenomic -S ../long_SG/processed_data/human/aligned_sam/A07_S7_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/A07_S7_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/A07_S7_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A07_S7.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A07_S7_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A07_S7_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A07_S7.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A07_S7_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A07_S7_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A07_S7.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A07_S7_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A07_S7_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A07_S7.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A07_S7_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A07_S7_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A07_S7.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A07_S7_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A07_S7_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A07_S7.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A07_S7_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A07_S7_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/A07_S7.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/A07_S7_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/A07_S7_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/A07_S7.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/A07_S7_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/A07_S7_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/A07_S7.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/A07_S7.breport -o ../long_SG/processed_data/metagenomic/bracken/A07_S7.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/A07_S7.breport -o ../long_SG/results/runs/run_2206_1816/krona/A07_S7.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/A07_S7.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/A07_S7.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/A07_S7.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/A08_S8_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=A08_S8
+ echo -e '\nProcessing sample: A08_S8'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A08_S8_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A08_S8_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A08_S8_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A08_S8_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A08_S8_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A08_S8_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A08_S8_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A08_S8_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A08_S8_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A08_S8_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A08_S8_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A08_S8_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/A08_S8_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/A08_S8_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/A08_S8_metagenomic -S ../long_SG/processed_data/human/aligned_sam/A08_S8_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/A08_S8_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/A08_S8_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A08_S8.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A08_S8_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A08_S8_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A08_S8.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A08_S8_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A08_S8_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A08_S8.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A08_S8_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A08_S8_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A08_S8.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A08_S8_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A08_S8_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A08_S8.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A08_S8_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A08_S8_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A08_S8.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A08_S8_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A08_S8_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/A08_S8.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/A08_S8_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/A08_S8_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/A08_S8.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/A08_S8_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/A08_S8_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/A08_S8.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/A08_S8.breport -o ../long_SG/processed_data/metagenomic/bracken/A08_S8.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/A08_S8.breport -o ../long_SG/results/runs/run_2206_1816/krona/A08_S8.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/A08_S8.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/A08_S8.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/A08_S8.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/A09_S9_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=A09_S9
+ echo -e '\nProcessing sample: A09_S9'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A09_S9_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A09_S9_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A09_S9_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A09_S9_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A09_S9_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A09_S9_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A09_S9_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A09_S9_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A09_S9_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A09_S9_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A09_S9_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A09_S9_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/A09_S9_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/A09_S9_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/A09_S9_metagenomic -S ../long_SG/processed_data/human/aligned_sam/A09_S9_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/A09_S9_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/A09_S9_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A09_S9.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A09_S9_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A09_S9_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A09_S9.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A09_S9_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A09_S9_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A09_S9.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A09_S9_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A09_S9_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A09_S9.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A09_S9_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A09_S9_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A09_S9.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A09_S9_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A09_S9_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A09_S9.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A09_S9_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A09_S9_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/A09_S9.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/A09_S9_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/A09_S9_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/A09_S9.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/A09_S9_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/A09_S9_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/A09_S9.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/A09_S9.breport -o ../long_SG/processed_data/metagenomic/bracken/A09_S9.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/A09_S9.breport -o ../long_SG/results/runs/run_2206_1816/krona/A09_S9.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/A09_S9.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/A09_S9.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/A09_S9.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/A10_S10_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=A10_S10
+ echo -e '\nProcessing sample: A10_S10'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A10_S10_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A10_S10_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A10_S10_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A10_S10_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A10_S10_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A10_S10_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A10_S10_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A10_S10_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A10_S10_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A10_S10_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A10_S10_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A10_S10_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/A10_S10_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/A10_S10_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/A10_S10_metagenomic -S ../long_SG/processed_data/human/aligned_sam/A10_S10_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/A10_S10_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/A10_S10_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A10_S10.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A10_S10_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A10_S10_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A10_S10.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A10_S10_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A10_S10_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A10_S10.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A10_S10_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A10_S10_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A10_S10.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A10_S10_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A10_S10_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A10_S10.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A10_S10_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A10_S10_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A10_S10.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A10_S10_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A10_S10_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/A10_S10.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/A10_S10_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/A10_S10_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/A10_S10.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/A10_S10_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/A10_S10_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/A10_S10.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/A10_S10.breport -o ../long_SG/processed_data/metagenomic/bracken/A10_S10.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/A10_S10.breport -o ../long_SG/results/runs/run_2206_1816/krona/A10_S10.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/A10_S10.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/A10_S10.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/A10_S10.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/A11_S11_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=A11_S11
+ echo -e '\nProcessing sample: A11_S11'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A11_S11_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A11_S11_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A11_S11_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A11_S11_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A11_S11_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A11_S11_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A11_S11_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A11_S11_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A11_S11_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A11_S11_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A11_S11_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A11_S11_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/A11_S11_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/A11_S11_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/A11_S11_metagenomic -S ../long_SG/processed_data/human/aligned_sam/A11_S11_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/A11_S11_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/A11_S11_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A11_S11.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A11_S11_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A11_S11_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A11_S11.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A11_S11_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A11_S11_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A11_S11.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A11_S11_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A11_S11_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A11_S11.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A11_S11_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A11_S11_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A11_S11.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A11_S11_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A11_S11_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A11_S11.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A11_S11_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A11_S11_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/A11_S11.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/A11_S11_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/A11_S11_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/A11_S11.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/A11_S11_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/A11_S11_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/A11_S11.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/A11_S11.breport -o ../long_SG/processed_data/metagenomic/bracken/A11_S11.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/A11_S11.breport -o ../long_SG/results/runs/run_2206_1816/krona/A11_S11.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/A11_S11.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/A11_S11.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/A11_S11.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/A12_S12_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=A12_S12
+ echo -e '\nProcessing sample: A12_S12'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A12_S12_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A12_S12_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A12_S12_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A12_S12_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A12_S12_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A12_S12_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A12_S12_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A12_S12_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/A12_S12_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/A12_S12_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/A12_S12_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/A12_S12_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/A12_S12_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/A12_S12_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/A12_S12_metagenomic -S ../long_SG/processed_data/human/aligned_sam/A12_S12_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/A12_S12_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/A12_S12_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A12_S12.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A12_S12_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A12_S12_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A12_S12.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A12_S12_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A12_S12_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A12_S12.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A12_S12_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A12_S12_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A12_S12.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A12_S12_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A12_S12_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/A12_S12.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/A12_S12_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/A12_S12_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/A12_S12.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/A12_S12_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/A12_S12_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/A12_S12.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/A12_S12_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/A12_S12_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/A12_S12.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/A12_S12_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/A12_S12_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/A12_S12.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/A12_S12.breport -o ../long_SG/processed_data/metagenomic/bracken/A12_S12.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/A12_S12.breport -o ../long_SG/results/runs/run_2206_1816/krona/A12_S12.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/A12_S12.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/A12_S12.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/A12_S12.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/B01_S13_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=B01_S13
+ echo -e '\nProcessing sample: B01_S13'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B01_S13_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B01_S13_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B01_S13_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B01_S13_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B01_S13_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B01_S13_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B01_S13_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B01_S13_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B01_S13_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B01_S13_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B01_S13_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B01_S13_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/B01_S13_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/B01_S13_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/B01_S13_metagenomic -S ../long_SG/processed_data/human/aligned_sam/B01_S13_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/B01_S13_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/B01_S13_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B01_S13.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B01_S13_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B01_S13_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B01_S13.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B01_S13_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B01_S13_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B01_S13.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B01_S13_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B01_S13_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B01_S13.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B01_S13_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B01_S13_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B01_S13.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B01_S13_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B01_S13_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B01_S13.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B01_S13_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B01_S13_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/B01_S13.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/B01_S13_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/B01_S13_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/B01_S13.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/B01_S13_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/B01_S13_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/B01_S13.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/B01_S13.breport -o ../long_SG/processed_data/metagenomic/bracken/B01_S13.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/B01_S13.breport -o ../long_SG/results/runs/run_2206_1816/krona/B01_S13.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/B01_S13.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/B01_S13.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/B01_S13.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/B02_S14_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=B02_S14
+ echo -e '\nProcessing sample: B02_S14'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B02_S14_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B02_S14_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B02_S14_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B02_S14_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B02_S14_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B02_S14_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B02_S14_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B02_S14_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B02_S14_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B02_S14_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B02_S14_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B02_S14_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/B02_S14_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/B02_S14_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/B02_S14_metagenomic -S ../long_SG/processed_data/human/aligned_sam/B02_S14_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/B02_S14_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/B02_S14_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B02_S14.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B02_S14_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B02_S14_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B02_S14.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B02_S14_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B02_S14_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B02_S14.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B02_S14_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B02_S14_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B02_S14.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B02_S14_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B02_S14_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B02_S14.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B02_S14_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B02_S14_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B02_S14.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B02_S14_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B02_S14_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/B02_S14.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/B02_S14_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/B02_S14_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/B02_S14.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/B02_S14_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/B02_S14_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/B02_S14.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/B02_S14.breport -o ../long_SG/processed_data/metagenomic/bracken/B02_S14.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/B02_S14.breport -o ../long_SG/results/runs/run_2206_1816/krona/B02_S14.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/B02_S14.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/B02_S14.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/B02_S14.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/B03_S15_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=B03_S15
+ echo -e '\nProcessing sample: B03_S15'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B03_S15_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B03_S15_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B03_S15_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B03_S15_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B03_S15_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B03_S15_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B03_S15_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B03_S15_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B03_S15_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B03_S15_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B03_S15_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B03_S15_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/B03_S15_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/B03_S15_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/B03_S15_metagenomic -S ../long_SG/processed_data/human/aligned_sam/B03_S15_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/B03_S15_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/B03_S15_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B03_S15.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B03_S15_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B03_S15_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B03_S15.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B03_S15_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B03_S15_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B03_S15.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B03_S15_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B03_S15_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B03_S15.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B03_S15_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B03_S15_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B03_S15.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B03_S15_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B03_S15_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B03_S15.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B03_S15_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B03_S15_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/B03_S15.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/B03_S15_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/B03_S15_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/B03_S15.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/B03_S15_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/B03_S15_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/B03_S15.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/B03_S15.breport -o ../long_SG/processed_data/metagenomic/bracken/B03_S15.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/B03_S15.breport -o ../long_SG/results/runs/run_2206_1816/krona/B03_S15.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/B03_S15.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/B03_S15.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/B03_S15.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/B04_S16_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=B04_S16
+ echo -e '\nProcessing sample: B04_S16'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B04_S16_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B04_S16_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B04_S16_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B04_S16_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B04_S16_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B04_S16_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B04_S16_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B04_S16_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B04_S16_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B04_S16_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B04_S16_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B04_S16_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/B04_S16_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/B04_S16_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/B04_S16_metagenomic -S ../long_SG/processed_data/human/aligned_sam/B04_S16_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/B04_S16_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/B04_S16_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B04_S16.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B04_S16_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B04_S16_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B04_S16.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B04_S16_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B04_S16_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B04_S16.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B04_S16_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B04_S16_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B04_S16.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B04_S16_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B04_S16_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B04_S16.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B04_S16_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B04_S16_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B04_S16.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B04_S16_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B04_S16_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/B04_S16.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/B04_S16_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/B04_S16_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/B04_S16.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/B04_S16_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/B04_S16_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/B04_S16.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/B04_S16.breport -o ../long_SG/processed_data/metagenomic/bracken/B04_S16.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/B04_S16.breport -o ../long_SG/results/runs/run_2206_1816/krona/B04_S16.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/B04_S16.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/B04_S16.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/B04_S16.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/B05_S17_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=B05_S17
+ echo -e '\nProcessing sample: B05_S17'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B05_S17_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B05_S17_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B05_S17_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B05_S17_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B05_S17_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B05_S17_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B05_S17_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B05_S17_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B05_S17_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B05_S17_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B05_S17_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B05_S17_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/B05_S17_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/B05_S17_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/B05_S17_metagenomic -S ../long_SG/processed_data/human/aligned_sam/B05_S17_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/B05_S17_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/B05_S17_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B05_S17.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B05_S17_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B05_S17_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B05_S17.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B05_S17_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B05_S17_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B05_S17.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B05_S17_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B05_S17_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B05_S17.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B05_S17_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B05_S17_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B05_S17.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B05_S17_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B05_S17_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B05_S17.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B05_S17_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B05_S17_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/B05_S17.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/B05_S17_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/B05_S17_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/B05_S17.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/B05_S17_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/B05_S17_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/B05_S17.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/B05_S17.breport -o ../long_SG/processed_data/metagenomic/bracken/B05_S17.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/B05_S17.breport -o ../long_SG/results/runs/run_2206_1816/krona/B05_S17.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/B05_S17.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/B05_S17.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/B05_S17.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/B06_S18_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=B06_S18
+ echo -e '\nProcessing sample: B06_S18'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B06_S18_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B06_S18_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B06_S18_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B06_S18_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B06_S18_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B06_S18_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B06_S18_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B06_S18_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B06_S18_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B06_S18_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B06_S18_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B06_S18_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/B06_S18_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/B06_S18_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/B06_S18_metagenomic -S ../long_SG/processed_data/human/aligned_sam/B06_S18_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/B06_S18_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/B06_S18_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B06_S18.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B06_S18_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B06_S18_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B06_S18.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B06_S18_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B06_S18_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B06_S18.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B06_S18_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B06_S18_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B06_S18.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B06_S18_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B06_S18_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B06_S18.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B06_S18_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B06_S18_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B06_S18.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B06_S18_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B06_S18_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/B06_S18.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/B06_S18_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/B06_S18_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/B06_S18.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/B06_S18_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/B06_S18_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/B06_S18.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/B06_S18.breport -o ../long_SG/processed_data/metagenomic/bracken/B06_S18.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/B06_S18.breport -o ../long_SG/results/runs/run_2206_1816/krona/B06_S18.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/B06_S18.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/B06_S18.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/B06_S18.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/B07_S19_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=B07_S19
+ echo -e '\nProcessing sample: B07_S19'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B07_S19_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B07_S19_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B07_S19_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B07_S19_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B07_S19_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B07_S19_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B07_S19_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B07_S19_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B07_S19_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B07_S19_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B07_S19_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B07_S19_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/B07_S19_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/B07_S19_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/B07_S19_metagenomic -S ../long_SG/processed_data/human/aligned_sam/B07_S19_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/B07_S19_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/B07_S19_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B07_S19.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B07_S19_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B07_S19_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B07_S19.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B07_S19_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B07_S19_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B07_S19.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B07_S19_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B07_S19_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B07_S19.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B07_S19_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B07_S19_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B07_S19.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B07_S19_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B07_S19_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B07_S19.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B07_S19_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B07_S19_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/B07_S19.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/B07_S19_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/B07_S19_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/B07_S19.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/B07_S19_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/B07_S19_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/B07_S19.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/B07_S19.breport -o ../long_SG/processed_data/metagenomic/bracken/B07_S19.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/B07_S19.breport -o ../long_SG/results/runs/run_2206_1816/krona/B07_S19.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/B07_S19.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/B07_S19.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/B07_S19.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/B08_S20_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=B08_S20
+ echo -e '\nProcessing sample: B08_S20'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B08_S20_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B08_S20_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B08_S20_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B08_S20_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B08_S20_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B08_S20_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B08_S20_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B08_S20_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B08_S20_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B08_S20_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B08_S20_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B08_S20_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/B08_S20_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/B08_S20_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/B08_S20_metagenomic -S ../long_SG/processed_data/human/aligned_sam/B08_S20_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/B08_S20_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/B08_S20_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B08_S20.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B08_S20_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B08_S20_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B08_S20.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B08_S20_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B08_S20_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B08_S20.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B08_S20_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B08_S20_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B08_S20.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B08_S20_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B08_S20_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B08_S20.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B08_S20_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B08_S20_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B08_S20.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B08_S20_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B08_S20_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/B08_S20.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/B08_S20_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/B08_S20_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/B08_S20.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/B08_S20_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/B08_S20_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/B08_S20.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/B08_S20.breport -o ../long_SG/processed_data/metagenomic/bracken/B08_S20.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/B08_S20.breport -o ../long_SG/results/runs/run_2206_1816/krona/B08_S20.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/B08_S20.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/B08_S20.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/B08_S20.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/B09_S21_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=B09_S21
+ echo -e '\nProcessing sample: B09_S21'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B09_S21_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B09_S21_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B09_S21_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B09_S21_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B09_S21_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B09_S21_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B09_S21_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B09_S21_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B09_S21_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B09_S21_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B09_S21_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B09_S21_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/B09_S21_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/B09_S21_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/B09_S21_metagenomic -S ../long_SG/processed_data/human/aligned_sam/B09_S21_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/B09_S21_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/B09_S21_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B09_S21.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B09_S21_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B09_S21_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B09_S21.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B09_S21_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B09_S21_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B09_S21.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B09_S21_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B09_S21_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B09_S21.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B09_S21_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B09_S21_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B09_S21.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B09_S21_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B09_S21_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B09_S21.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B09_S21_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B09_S21_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/B09_S21.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/B09_S21_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/B09_S21_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/B09_S21.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/B09_S21_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/B09_S21_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/B09_S21.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/B09_S21.breport -o ../long_SG/processed_data/metagenomic/bracken/B09_S21.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/B09_S21.breport -o ../long_SG/results/runs/run_2206_1816/krona/B09_S21.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/B09_S21.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/B09_S21.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/B09_S21.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/B10_S22_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=B10_S22
+ echo -e '\nProcessing sample: B10_S22'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B10_S22_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B10_S22_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B10_S22_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B10_S22_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B10_S22_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B10_S22_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B10_S22_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B10_S22_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B10_S22_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B10_S22_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B10_S22_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B10_S22_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/B10_S22_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/B10_S22_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/B10_S22_metagenomic -S ../long_SG/processed_data/human/aligned_sam/B10_S22_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/B10_S22_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/B10_S22_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B10_S22.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B10_S22_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B10_S22_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B10_S22.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B10_S22_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B10_S22_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B10_S22.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B10_S22_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B10_S22_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B10_S22.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B10_S22_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B10_S22_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B10_S22.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B10_S22_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B10_S22_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B10_S22.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B10_S22_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B10_S22_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/B10_S22.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/B10_S22_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/B10_S22_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/B10_S22.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/B10_S22_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/B10_S22_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/B10_S22.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/B10_S22.breport -o ../long_SG/processed_data/metagenomic/bracken/B10_S22.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/B10_S22.breport -o ../long_SG/results/runs/run_2206_1816/krona/B10_S22.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/B10_S22.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/B10_S22.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/B10_S22.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/B11_S23_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=B11_S23
+ echo -e '\nProcessing sample: B11_S23'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B11_S23_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B11_S23_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B11_S23_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B11_S23_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B11_S23_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B11_S23_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B11_S23_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B11_S23_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B11_S23_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B11_S23_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B11_S23_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B11_S23_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/B11_S23_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/B11_S23_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/B11_S23_metagenomic -S ../long_SG/processed_data/human/aligned_sam/B11_S23_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/B11_S23_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/B11_S23_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B11_S23.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B11_S23_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B11_S23_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B11_S23.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B11_S23_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B11_S23_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B11_S23.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B11_S23_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B11_S23_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B11_S23.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B11_S23_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B11_S23_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B11_S23.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B11_S23_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B11_S23_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B11_S23.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B11_S23_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B11_S23_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/B11_S23.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/B11_S23_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/B11_S23_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/B11_S23.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/B11_S23_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/B11_S23_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/B11_S23.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/B11_S23.breport -o ../long_SG/processed_data/metagenomic/bracken/B11_S23.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/B11_S23.breport -o ../long_SG/results/runs/run_2206_1816/krona/B11_S23.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/B11_S23.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/B11_S23.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/B11_S23.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/B12_S24_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=B12_S24
+ echo -e '\nProcessing sample: B12_S24'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B12_S24_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B12_S24_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B12_S24_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B12_S24_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B12_S24_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B12_S24_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B12_S24_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B12_S24_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/B12_S24_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/B12_S24_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/B12_S24_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/B12_S24_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/B12_S24_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/B12_S24_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/B12_S24_metagenomic -S ../long_SG/processed_data/human/aligned_sam/B12_S24_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/B12_S24_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/B12_S24_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B12_S24.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B12_S24_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B12_S24_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B12_S24.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B12_S24_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B12_S24_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B12_S24.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B12_S24_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B12_S24_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B12_S24.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B12_S24_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B12_S24_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/B12_S24.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/B12_S24_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/B12_S24_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/B12_S24.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/B12_S24_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/B12_S24_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/B12_S24.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/B12_S24_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/B12_S24_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/B12_S24.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/B12_S24_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/B12_S24_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/B12_S24.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/B12_S24.breport -o ../long_SG/processed_data/metagenomic/bracken/B12_S24.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/B12_S24.breport -o ../long_SG/results/runs/run_2206_1816/krona/B12_S24.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/B12_S24.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/B12_S24.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/B12_S24.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/Blank_S38_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=Blank_S38
+ echo -e '\nProcessing sample: Blank_S38'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/Blank_S38_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/Blank_S38_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/Blank_S38_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/Blank_S38_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/Blank_S38_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/Blank_S38_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/Blank_S38_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/Blank_S38_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/Blank_S38_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/Blank_S38_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/Blank_S38_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/Blank_S38_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/Blank_S38_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/Blank_S38_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/Blank_S38_metagenomic -S ../long_SG/processed_data/human/aligned_sam/Blank_S38_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/Blank_S38_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/Blank_S38_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/Blank_S38.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/Blank_S38_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/Blank_S38_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/Blank_S38.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/Blank_S38_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/Blank_S38_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/Blank_S38.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/Blank_S38_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/Blank_S38_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/Blank_S38.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/Blank_S38_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/Blank_S38_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/Blank_S38.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/Blank_S38_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/Blank_S38_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/Blank_S38.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/Blank_S38_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/Blank_S38_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/Blank_S38.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/Blank_S38_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/Blank_S38_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/Blank_S38.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/Blank_S38_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/Blank_S38_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/Blank_S38.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/Blank_S38.breport -o ../long_SG/processed_data/metagenomic/bracken/Blank_S38.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/Blank_S38.breport -o ../long_SG/results/runs/run_2206_1816/krona/Blank_S38.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/Blank_S38.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/Blank_S38.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/Blank_S38.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/C01_S25_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=C01_S25
+ echo -e '\nProcessing sample: C01_S25'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C01_S25_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C01_S25_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C01_S25_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C01_S25_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C01_S25_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C01_S25_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C01_S25_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C01_S25_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C01_S25_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C01_S25_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C01_S25_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C01_S25_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/C01_S25_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/C01_S25_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/C01_S25_metagenomic -S ../long_SG/processed_data/human/aligned_sam/C01_S25_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/C01_S25_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/C01_S25_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C01_S25.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C01_S25_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C01_S25_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C01_S25.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C01_S25_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C01_S25_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C01_S25.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C01_S25_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C01_S25_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C01_S25.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C01_S25_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C01_S25_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C01_S25.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C01_S25_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C01_S25_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C01_S25.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C01_S25_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C01_S25_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/C01_S25.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/C01_S25_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/C01_S25_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/C01_S25.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/C01_S25_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/C01_S25_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/C01_S25.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/C01_S25.breport -o ../long_SG/processed_data/metagenomic/bracken/C01_S25.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/C01_S25.breport -o ../long_SG/results/runs/run_2206_1816/krona/C01_S25.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/C01_S25.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/C01_S25.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/C01_S25.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/C02_S26_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=C02_S26
+ echo -e '\nProcessing sample: C02_S26'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C02_S26_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C02_S26_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C02_S26_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C02_S26_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C02_S26_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C02_S26_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C02_S26_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C02_S26_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C02_S26_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C02_S26_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C02_S26_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C02_S26_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/C02_S26_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/C02_S26_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/C02_S26_metagenomic -S ../long_SG/processed_data/human/aligned_sam/C02_S26_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/C02_S26_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/C02_S26_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C02_S26.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C02_S26_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C02_S26_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C02_S26.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C02_S26_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C02_S26_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C02_S26.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C02_S26_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C02_S26_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C02_S26.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C02_S26_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C02_S26_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C02_S26.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C02_S26_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C02_S26_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C02_S26.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C02_S26_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C02_S26_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/C02_S26.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/C02_S26_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/C02_S26_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/C02_S26.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/C02_S26_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/C02_S26_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/C02_S26.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/C02_S26.breport -o ../long_SG/processed_data/metagenomic/bracken/C02_S26.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/C02_S26.breport -o ../long_SG/results/runs/run_2206_1816/krona/C02_S26.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/C02_S26.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/C02_S26.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/C02_S26.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/C03_S27_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=C03_S27
+ echo -e '\nProcessing sample: C03_S27'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C03_S27_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C03_S27_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C03_S27_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C03_S27_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C03_S27_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C03_S27_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C03_S27_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C03_S27_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C03_S27_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C03_S27_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C03_S27_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C03_S27_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/C03_S27_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/C03_S27_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/C03_S27_metagenomic -S ../long_SG/processed_data/human/aligned_sam/C03_S27_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/C03_S27_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/C03_S27_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C03_S27.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C03_S27_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C03_S27_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C03_S27.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C03_S27_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C03_S27_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C03_S27.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C03_S27_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C03_S27_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C03_S27.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C03_S27_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C03_S27_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C03_S27.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C03_S27_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C03_S27_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C03_S27.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C03_S27_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C03_S27_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/C03_S27.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/C03_S27_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/C03_S27_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/C03_S27.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/C03_S27_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/C03_S27_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/C03_S27.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/C03_S27.breport -o ../long_SG/processed_data/metagenomic/bracken/C03_S27.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/C03_S27.breport -o ../long_SG/results/runs/run_2206_1816/krona/C03_S27.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/C03_S27.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/C03_S27.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/C03_S27.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/C04_S28_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=C04_S28
+ echo -e '\nProcessing sample: C04_S28'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C04_S28_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C04_S28_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C04_S28_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C04_S28_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C04_S28_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C04_S28_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C04_S28_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C04_S28_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C04_S28_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C04_S28_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C04_S28_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C04_S28_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/C04_S28_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/C04_S28_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/C04_S28_metagenomic -S ../long_SG/processed_data/human/aligned_sam/C04_S28_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/C04_S28_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/C04_S28_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C04_S28.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C04_S28_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C04_S28_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C04_S28.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C04_S28_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C04_S28_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C04_S28.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C04_S28_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C04_S28_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C04_S28.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C04_S28_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C04_S28_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C04_S28.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C04_S28_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C04_S28_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C04_S28.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C04_S28_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C04_S28_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/C04_S28.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/C04_S28_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/C04_S28_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/C04_S28.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/C04_S28_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/C04_S28_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/C04_S28.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/C04_S28.breport -o ../long_SG/processed_data/metagenomic/bracken/C04_S28.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/C04_S28.breport -o ../long_SG/results/runs/run_2206_1816/krona/C04_S28.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/C04_S28.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/C04_S28.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/C04_S28.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/C05_S29_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=C05_S29
+ echo -e '\nProcessing sample: C05_S29'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C05_S29_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C05_S29_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C05_S29_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C05_S29_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C05_S29_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C05_S29_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C05_S29_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C05_S29_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C05_S29_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C05_S29_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C05_S29_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C05_S29_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/C05_S29_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/C05_S29_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/C05_S29_metagenomic -S ../long_SG/processed_data/human/aligned_sam/C05_S29_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/C05_S29_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/C05_S29_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C05_S29.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C05_S29_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C05_S29_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C05_S29.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C05_S29_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C05_S29_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C05_S29.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C05_S29_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C05_S29_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C05_S29.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C05_S29_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C05_S29_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C05_S29.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C05_S29_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C05_S29_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C05_S29.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C05_S29_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C05_S29_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/C05_S29.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/C05_S29_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/C05_S29_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/C05_S29.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/C05_S29_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/C05_S29_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/C05_S29.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/C05_S29.breport -o ../long_SG/processed_data/metagenomic/bracken/C05_S29.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/C05_S29.breport -o ../long_SG/results/runs/run_2206_1816/krona/C05_S29.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/C05_S29.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/C05_S29.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/C05_S29.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/C06_S30_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=C06_S30
+ echo -e '\nProcessing sample: C06_S30'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C06_S30_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C06_S30_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C06_S30_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C06_S30_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C06_S30_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C06_S30_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C06_S30_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C06_S30_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C06_S30_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C06_S30_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C06_S30_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C06_S30_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/C06_S30_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/C06_S30_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/C06_S30_metagenomic -S ../long_SG/processed_data/human/aligned_sam/C06_S30_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/C06_S30_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/C06_S30_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C06_S30.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C06_S30_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C06_S30_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C06_S30.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C06_S30_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C06_S30_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C06_S30.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C06_S30_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C06_S30_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C06_S30.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C06_S30_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C06_S30_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C06_S30.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C06_S30_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C06_S30_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C06_S30.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C06_S30_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C06_S30_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/C06_S30.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/C06_S30_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/C06_S30_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/C06_S30.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/C06_S30_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/C06_S30_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/C06_S30.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/C06_S30.breport -o ../long_SG/processed_data/metagenomic/bracken/C06_S30.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/C06_S30.breport -o ../long_SG/results/runs/run_2206_1816/krona/C06_S30.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/C06_S30.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/C06_S30.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/C06_S30.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/C07_S31_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=C07_S31
+ echo -e '\nProcessing sample: C07_S31'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C07_S31_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C07_S31_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C07_S31_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C07_S31_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C07_S31_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C07_S31_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C07_S31_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C07_S31_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C07_S31_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C07_S31_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C07_S31_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C07_S31_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/C07_S31_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/C07_S31_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/C07_S31_metagenomic -S ../long_SG/processed_data/human/aligned_sam/C07_S31_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/C07_S31_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/C07_S31_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C07_S31.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C07_S31_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C07_S31_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C07_S31.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C07_S31_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C07_S31_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C07_S31.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C07_S31_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C07_S31_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C07_S31.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C07_S31_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C07_S31_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C07_S31.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C07_S31_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C07_S31_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C07_S31.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C07_S31_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C07_S31_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/C07_S31.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/C07_S31_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/C07_S31_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/C07_S31.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/C07_S31_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/C07_S31_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/C07_S31.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/C07_S31.breport -o ../long_SG/processed_data/metagenomic/bracken/C07_S31.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/C07_S31.breport -o ../long_SG/results/runs/run_2206_1816/krona/C07_S31.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/C07_S31.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/C07_S31.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/C07_S31.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/C08_S32_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=C08_S32
+ echo -e '\nProcessing sample: C08_S32'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C08_S32_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C08_S32_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C08_S32_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C08_S32_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C08_S32_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C08_S32_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C08_S32_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C08_S32_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C08_S32_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C08_S32_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C08_S32_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C08_S32_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/C08_S32_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/C08_S32_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/C08_S32_metagenomic -S ../long_SG/processed_data/human/aligned_sam/C08_S32_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/C08_S32_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/C08_S32_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C08_S32.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C08_S32_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C08_S32_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C08_S32.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C08_S32_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C08_S32_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C08_S32.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C08_S32_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C08_S32_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C08_S32.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C08_S32_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C08_S32_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C08_S32.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C08_S32_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C08_S32_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C08_S32.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C08_S32_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C08_S32_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/C08_S32.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/C08_S32_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/C08_S32_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/C08_S32.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/C08_S32_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/C08_S32_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/C08_S32.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/C08_S32.breport -o ../long_SG/processed_data/metagenomic/bracken/C08_S32.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/C08_S32.breport -o ../long_SG/results/runs/run_2206_1816/krona/C08_S32.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/C08_S32.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/C08_S32.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/C08_S32.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/C09_S33_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=C09_S33
+ echo -e '\nProcessing sample: C09_S33'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C09_S33_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C09_S33_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C09_S33_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C09_S33_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C09_S33_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C09_S33_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C09_S33_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C09_S33_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C09_S33_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C09_S33_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C09_S33_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C09_S33_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/C09_S33_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/C09_S33_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/C09_S33_metagenomic -S ../long_SG/processed_data/human/aligned_sam/C09_S33_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/C09_S33_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/C09_S33_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C09_S33.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C09_S33_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C09_S33_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C09_S33.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C09_S33_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C09_S33_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C09_S33.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C09_S33_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C09_S33_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C09_S33.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C09_S33_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C09_S33_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C09_S33.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C09_S33_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C09_S33_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C09_S33.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C09_S33_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C09_S33_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/C09_S33.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/C09_S33_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/C09_S33_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/C09_S33.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/C09_S33_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/C09_S33_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/C09_S33.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/C09_S33.breport -o ../long_SG/processed_data/metagenomic/bracken/C09_S33.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/C09_S33.breport -o ../long_SG/results/runs/run_2206_1816/krona/C09_S33.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/C09_S33.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/C09_S33.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/C09_S33.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/C10_S34_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=C10_S34
+ echo -e '\nProcessing sample: C10_S34'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C10_S34_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C10_S34_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C10_S34_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C10_S34_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C10_S34_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C10_S34_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C10_S34_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C10_S34_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C10_S34_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C10_S34_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C10_S34_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C10_S34_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/C10_S34_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/C10_S34_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/C10_S34_metagenomic -S ../long_SG/processed_data/human/aligned_sam/C10_S34_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/C10_S34_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/C10_S34_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C10_S34.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C10_S34_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C10_S34_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C10_S34.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C10_S34_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C10_S34_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C10_S34.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C10_S34_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C10_S34_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C10_S34.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C10_S34_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C10_S34_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C10_S34.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C10_S34_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C10_S34_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C10_S34.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C10_S34_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C10_S34_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/C10_S34.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/C10_S34_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/C10_S34_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/C10_S34.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/C10_S34_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/C10_S34_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/C10_S34.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/C10_S34.breport -o ../long_SG/processed_data/metagenomic/bracken/C10_S34.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/C10_S34.breport -o ../long_SG/results/runs/run_2206_1816/krona/C10_S34.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/C10_S34.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/C10_S34.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/C10_S34.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/C11_S35_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=C11_S35
+ echo -e '\nProcessing sample: C11_S35'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C11_S35_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C11_S35_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C11_S35_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C11_S35_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C11_S35_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C11_S35_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C11_S35_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C11_S35_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C11_S35_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C11_S35_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C11_S35_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C11_S35_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/C11_S35_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/C11_S35_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/C11_S35_metagenomic -S ../long_SG/processed_data/human/aligned_sam/C11_S35_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/C11_S35_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/C11_S35_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C11_S35.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C11_S35_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C11_S35_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C11_S35.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C11_S35_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C11_S35_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C11_S35.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C11_S35_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C11_S35_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C11_S35.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C11_S35_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C11_S35_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C11_S35.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C11_S35_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C11_S35_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C11_S35.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C11_S35_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C11_S35_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/C11_S35.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/C11_S35_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/C11_S35_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/C11_S35.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/C11_S35_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/C11_S35_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/C11_S35.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/C11_S35.breport -o ../long_SG/processed_data/metagenomic/bracken/C11_S35.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/C11_S35.breport -o ../long_SG/results/runs/run_2206_1816/krona/C11_S35.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/C11_S35.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/C11_S35.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/C11_S35.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/C12_S36_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=C12_S36
+ echo -e '\nProcessing sample: C12_S36'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C12_S36_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C12_S36_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C12_S36_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C12_S36_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C12_S36_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C12_S36_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C12_S36_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C12_S36_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/C12_S36_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/C12_S36_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/C12_S36_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/C12_S36_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/C12_S36_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/C12_S36_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/C12_S36_metagenomic -S ../long_SG/processed_data/human/aligned_sam/C12_S36_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/C12_S36_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/C12_S36_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C12_S36.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C12_S36_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C12_S36_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C12_S36.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C12_S36_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C12_S36_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C12_S36.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C12_S36_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C12_S36_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C12_S36.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C12_S36_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C12_S36_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/C12_S36.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/C12_S36_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/C12_S36_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/C12_S36.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/C12_S36_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/C12_S36_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/C12_S36.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/C12_S36_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/C12_S36_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/C12_S36.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/C12_S36_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/C12_S36_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/C12_S36.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/C12_S36.breport -o ../long_SG/processed_data/metagenomic/bracken/C12_S36.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/C12_S36.breport -o ../long_SG/results/runs/run_2206_1816/krona/C12_S36.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/C12_S36.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/C12_S36.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/C12_S36.krona.txt
+ echo '✅  Krona plot generated.'
+ for R1 in "$TRIMMED_DIR"/paired/*_R1_paired.fastq.gz
++ basename ../long_SG/processed_data/trimmed/paired/ENC_S37_R1_paired.fastq.gz _R1_paired.fastq.gz
+ base=ENC_S37
+ echo -e '\nProcessing sample: ENC_S37'
+ [[ true == true ]]
+ echo -e '\nRemoving human reads with Bowtie2...'
+ BOWTIE_CMD='bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/ENC_S37_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/ENC_S37_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/ENC_S37_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/ENC_S37_human.sam" 2>&1'
+ echo 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/ENC_S37_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/ENC_S37_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/ENC_S37_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/ENC_S37_human.sam" 2>&1'
+ eval 'bowtie2 -x "/scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as" -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant 	                -1 "../long_SG/processed_data/trimmed/paired/ENC_S37_R1_paired.fastq.gz" -2 "../long_SG/processed_data/trimmed/paired/ENC_S37_R2_paired.fastq.gz" 	                --un-conc "../long_SG/processed_data/metagenomic/filtered_fastq/ENC_S37_metagenomic" -S "../long_SG/processed_data/human/aligned_sam/ENC_S37_human.sam" 2>&1'
++ bowtie2 -x /scratch/prj/aef_forensic_metagenomics/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as -p 8 -q --end-to-end --very-sensitive --no-mixed --no-discordant -1 ../long_SG/processed_data/trimmed/paired/ENC_S37_R1_paired.fastq.gz -2 ../long_SG/processed_data/trimmed/paired/ENC_S37_R2_paired.fastq.gz --un-conc ../long_SG/processed_data/metagenomic/filtered_fastq/ENC_S37_metagenomic -S ../long_SG/processed_data/human/aligned_sam/ENC_S37_human.sam
+ echo '✅  Host reads removed.'
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/ENC_S37_metagenomic.1 ]]
+ [[ ! -f ../long_SG/processed_data/metagenomic/filtered_fastq/ENC_S37_metagenomic.2 ]]
+ echo -e '\nClassifying metagenomic reads with Kraken2...'
+ KRAKEN_CMD='kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/ENC_S37.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/ENC_S37_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/ENC_S37_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/ENC_S37.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/ENC_S37_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/ENC_S37_metagenomic.2" 2>&1'
+ echo 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/ENC_S37.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/ENC_S37_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/ENC_S37_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/ENC_S37.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/ENC_S37_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/ENC_S37_metagenomic.2" 2>&1'
+ eval 'kraken2 --db "../data/databases/k2_pluspfp_20250402/" --threads 8 --report "../long_SG/results/runs/run_2206_1816/reports/ENC_S37.k2report" 		--report-minimizer-data --paired --minimum-hit-groups 3 		--classified-out "../long_SG/processed_data/metagenomic/classified/ENC_S37_classified#.fastq" --unclassified-out "../long_SG/processed_data/metagenomic/unclassified/ENC_S37_unclassified#.fastq" 		--output "../long_SG/processed_data/metagenomic/kraken2/ENC_S37.kraken2" --use-names "../long_SG/processed_data/metagenomic/filtered_fastq/ENC_S37_metagenomic.1" "../long_SG/processed_data/metagenomic/filtered_fastq/ENC_S37_metagenomic.2" 2>&1'
++ kraken2 --db ../data/databases/k2_pluspfp_20250402/ --threads 8 --report ../long_SG/results/runs/run_2206_1816/reports/ENC_S37.k2report --report-minimizer-data --paired --minimum-hit-groups 3 --classified-out ../long_SG/processed_data/metagenomic/classified/ENC_S37_classified#.fastq --unclassified-out ../long_SG/processed_data/metagenomic/unclassified/ENC_S37_unclassified#.fastq --output ../long_SG/processed_data/metagenomic/kraken2/ENC_S37.kraken2 --use-names ../long_SG/processed_data/metagenomic/filtered_fastq/ENC_S37_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/ENC_S37_metagenomic.2
+ echo '✅  Classification complete.'
+ echo -e '\nEstimating species abundance with Bracken...'
+ bracken -d ../data/databases/k2_pluspfp_20250402/ -i ../long_SG/results/runs/run_2206_1816/reports/ENC_S37.k2report -l S -r 100 -t 40 -w ../long_SG/results/runs/run_2206_1816/reports/ENC_S37.breport -o ../long_SG/processed_data/metagenomic/bracken/ENC_S37.bracken
+ echo '✅  Abundance estimated.'
+ echo -e '\nGenerating Krona visualization...'
+ python /scratch/prj/aef_forensic_metagenomics/tools/KrakenTools/kreport2krona.py -r ../long_SG/results/runs/run_2206_1816/reports/ENC_S37.breport -o ../long_SG/results/runs/run_2206_1816/krona/ENC_S37.krona.txt --no-intermediate-ranks
+ /scratch/prj/aef_forensic_metagenomics/tools/Krona/KronaTools/scripts/ImportText.pl ../long_SG/results/runs/run_2206_1816/krona/ENC_S37.krona.txt -o ../long_SG/results/runs/run_2206_1816/krona/ENC_S37.krona.html
+ rm ../long_SG/results/runs/run_2206_1816/krona/ENC_S37.krona.txt
+ echo '✅  Krona plot generated.'
++ date +%s
+ END_TIME=1750618255
+ DURATION=5660
+ printf -v FORMATTED_DURATION %02d:%02d:%02d 1 34 20
+ echo -e '\nMetagenomic classification completed in: 01:34:20'
+ echo -e '\nCalculating read length statistics...'
+ files=("$FILTERED_FASTQ_DIR"/*.1 "$FILTERED_FASTQ_DIR"/*.2 "$CLASSIFIED_DIR"/*.fastq "$UNCLASSIFIED_DIR"/*.fastq)
+ /scratch/prj/aef_forensic_metagenomics/scripts/helper_scripts/get_fastq_stats.sh ../long_SG/processed_data/metagenomic/filtered_fastq/A01_S1_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/A02_S2_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/A03_S3_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/A04_S4_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/A05_S5_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/A06_S6_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/A07_S7_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/A08_S8_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/A09_S9_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/A10_S10_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/A11_S11_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/A12_S12_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/B01_S13_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/B02_S14_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/B03_S15_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/B04_S16_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/B05_S17_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/B06_S18_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/B07_S19_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/B08_S20_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/B09_S21_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/B10_S22_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/B11_S23_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/B12_S24_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/Blank_S38_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/C01_S25_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/C02_S26_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/C03_S27_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/C04_S28_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/C05_S29_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/C06_S30_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/C07_S31_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/C08_S32_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/C09_S33_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/C10_S34_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/C11_S35_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/C12_S36_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/ENC_S37_metagenomic.1 ../long_SG/processed_data/metagenomic/filtered_fastq/A01_S1_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/A02_S2_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/A03_S3_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/A04_S4_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/A05_S5_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/A06_S6_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/A07_S7_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/A08_S8_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/A09_S9_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/A10_S10_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/A11_S11_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/A12_S12_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/B01_S13_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/B02_S14_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/B03_S15_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/B04_S16_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/B05_S17_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/B06_S18_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/B07_S19_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/B08_S20_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/B09_S21_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/B10_S22_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/B11_S23_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/B12_S24_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/Blank_S38_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/C01_S25_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/C02_S26_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/C03_S27_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/C04_S28_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/C05_S29_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/C06_S30_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/C07_S31_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/C08_S32_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/C09_S33_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/C10_S34_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/C11_S35_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/C12_S36_metagenomic.2 ../long_SG/processed_data/metagenomic/filtered_fastq/ENC_S37_metagenomic.2 ../long_SG/processed_data/metagenomic/classified/A01_S1_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/A01_S1_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/A02_S2_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/A02_S2_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/A03_S3_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/A03_S3_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/A04_S4_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/A04_S4_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/A05_S5_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/A05_S5_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/A06_S6_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/A06_S6_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/A07_S7_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/A07_S7_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/A08_S8_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/A08_S8_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/A09_S9_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/A09_S9_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/A10_S10_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/A10_S10_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/A11_S11_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/A11_S11_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/A12_S12_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/A12_S12_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/B01_S13_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/B01_S13_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/B02_S14_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/B02_S14_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/B03_S15_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/B03_S15_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/B04_S16_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/B04_S16_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/B05_S17_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/B05_S17_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/B06_S18_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/B06_S18_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/B07_S19_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/B07_S19_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/B08_S20_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/B08_S20_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/B09_S21_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/B09_S21_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/B10_S22_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/B10_S22_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/B11_S23_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/B11_S23_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/B12_S24_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/B12_S24_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/Blank_S38_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/Blank_S38_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/C01_S25_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/C01_S25_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/C02_S26_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/C02_S26_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/C03_S27_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/C03_S27_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/C04_S28_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/C04_S28_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/C05_S29_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/C05_S29_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/C06_S30_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/C06_S30_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/C07_S31_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/C07_S31_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/C08_S32_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/C08_S32_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/C09_S33_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/C09_S33_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/C10_S34_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/C10_S34_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/C11_S35_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/C11_S35_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/C12_S36_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/C12_S36_classified_2.fastq ../long_SG/processed_data/metagenomic/classified/ENC_S37_classified_1.fastq ../long_SG/processed_data/metagenomic/classified/ENC_S37_classified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/A01_S1_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/A01_S1_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/A02_S2_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/A02_S2_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/A03_S3_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/A03_S3_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/A04_S4_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/A04_S4_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/A05_S5_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/A05_S5_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/A06_S6_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/A06_S6_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/A07_S7_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/A07_S7_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/A08_S8_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/A08_S8_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/A09_S9_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/A09_S9_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/A10_S10_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/A10_S10_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/A11_S11_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/A11_S11_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/A12_S12_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/A12_S12_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/B01_S13_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/B01_S13_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/B02_S14_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/B02_S14_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/B03_S15_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/B03_S15_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/B04_S16_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/B04_S16_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/B05_S17_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/B05_S17_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/B06_S18_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/B06_S18_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/B07_S19_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/B07_S19_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/B08_S20_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/B08_S20_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/B09_S21_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/B09_S21_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/B10_S22_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/B10_S22_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/B11_S23_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/B11_S23_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/B12_S24_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/B12_S24_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/Blank_S38_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/Blank_S38_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/C01_S25_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/C01_S25_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/C02_S26_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/C02_S26_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/C03_S27_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/C03_S27_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/C04_S28_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/C04_S28_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/C05_S29_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/C05_S29_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/C06_S30_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/C06_S30_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/C07_S31_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/C07_S31_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/C08_S32_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/C08_S32_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/C09_S33_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/C09_S33_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/C10_S34_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/C10_S34_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/C11_S35_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/C11_S35_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/C12_S36_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/C12_S36_unclassified_2.fastq ../long_SG/processed_data/metagenomic/unclassified/ENC_S37_unclassified_1.fastq ../long_SG/processed_data/metagenomic/unclassified/ENC_S37_unclassified_2.fastq
+ echo '✅ Statistics generated.'
+ echo -e '\nCombining Bracken reports...'
+ Rscript /scratch/prj/aef_forensic_metagenomics/scripts/helper_scripts/combine_breports.R ../long_SG/results/runs/run_2206_1816/reports/A01_S1.breport ../long_SG/results/runs/run_2206_1816/reports/A02_S2.breport ../long_SG/results/runs/run_2206_1816/reports/A03_S3.breport ../long_SG/results/runs/run_2206_1816/reports/A04_S4.breport ../long_SG/results/runs/run_2206_1816/reports/A05_S5.breport ../long_SG/results/runs/run_2206_1816/reports/A06_S6.breport ../long_SG/results/runs/run_2206_1816/reports/A07_S7.breport ../long_SG/results/runs/run_2206_1816/reports/A08_S8.breport ../long_SG/results/runs/run_2206_1816/reports/A09_S9.breport ../long_SG/results/runs/run_2206_1816/reports/A10_S10.breport ../long_SG/results/runs/run_2206_1816/reports/A11_S11.breport ../long_SG/results/runs/run_2206_1816/reports/A12_S12.breport ../long_SG/results/runs/run_2206_1816/reports/B01_S13.breport ../long_SG/results/runs/run_2206_1816/reports/B02_S14.breport ../long_SG/results/runs/run_2206_1816/reports/B03_S15.breport ../long_SG/results/runs/run_2206_1816/reports/B04_S16.breport ../long_SG/results/runs/run_2206_1816/reports/B05_S17.breport ../long_SG/results/runs/run_2206_1816/reports/B06_S18.breport ../long_SG/results/runs/run_2206_1816/reports/B07_S19.breport ../long_SG/results/runs/run_2206_1816/reports/B08_S20.breport ../long_SG/results/runs/run_2206_1816/reports/B09_S21.breport ../long_SG/results/runs/run_2206_1816/reports/B10_S22.breport ../long_SG/results/runs/run_2206_1816/reports/B11_S23.breport ../long_SG/results/runs/run_2206_1816/reports/B12_S24.breport ../long_SG/results/runs/run_2206_1816/reports/Blank_S38.breport ../long_SG/results/runs/run_2206_1816/reports/C01_S25.breport ../long_SG/results/runs/run_2206_1816/reports/C02_S26.breport ../long_SG/results/runs/run_2206_1816/reports/C03_S27.breport ../long_SG/results/runs/run_2206_1816/reports/C04_S28.breport ../long_SG/results/runs/run_2206_1816/reports/C05_S29.breport ../long_SG/results/runs/run_2206_1816/reports/C06_S30.breport ../long_SG/results/runs/run_2206_1816/reports/C07_S31.breport ../long_SG/results/runs/run_2206_1816/reports/C08_S32.breport ../long_SG/results/runs/run_2206_1816/reports/C09_S33.breport ../long_SG/results/runs/run_2206_1816/reports/C10_S34.breport ../long_SG/results/runs/run_2206_1816/reports/C11_S35.breport ../long_SG/results/runs/run_2206_1816/reports/C12_S36.breport ../long_SG/results/runs/run_2206_1816/reports/ENC_S37.breport
+ echo '✅ Bracken reports combined.'
+ echo -e '\nCopying SLURM job logs...'
+ cp /scratch/prj/aef_forensic_metagenomics/scripts/logs/pipeline_27015829.err /scratch/prj/aef_forensic_metagenomics/scripts/logs/pipeline_27015829.log ../long_SG/results/runs/run_2206_1816/logs
