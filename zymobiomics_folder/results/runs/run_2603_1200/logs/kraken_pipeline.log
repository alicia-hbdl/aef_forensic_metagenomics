
================================================= CONDA ENVIRONMENT ACTIVATION ==================================================

================================================= ARGUMENT PARSING & VALIDATION =================================================
Raw FASTQ directory path: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/raw_data/
Database path: /scratch/users/k24087895/final_project/metagenome_analysis/data/databases/k2_standard_16gb_20241228
‚ö†Ô∏è Warning: No Bowtie2 index prefix provided. Using default prefix: /scratch/users/k24087895/final_project/metagenome_analysis/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as
‚úÖ Trimming enabled.

======================================================= PIPELINE SUMMARY ========================================================
Quality Control & Trimming: Enabled ‚úÖ
‚ö†Ô∏è This step is optional, but it must have been performed at least once on the raw reads for the rest of the pipeline to function correctly.

Host DNA Removal: Enabled ‚úÖ
Host DNA Bowtie2 Index Prefix: /scratch/users/k24087895/final_project/metagenome_analysis/data/bowtie_index/GRCh38_noalt_as/GRCh38_noalt_as
‚ö†Ô∏è This step is optional, but it must have been performed at least once on the trimmed reads for the rest of the pipeline to function correctly.

Kraken2/Bracken Database Path: /scratch/users/k24087895/final_project/metagenome_analysis/data/databases/k2_standard_16gb_20241228
=================================================================================================================================

====================================================== DIRECTORY STRUCTURE ======================================================
‚úÖ All output directories created successfully.

=================================================== QUALITY CONTROL & TRIMMING ===================================================

Running FastQC on all raw reads...
‚úÖ FastQC completed successfully.

/// MultiQC üîç v1.27.1

     version_check | MultiQC Version v1.28 now available!
       file_search | Search path: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/fastqc/pre_trimming

            fastqc | Found 14 reports

     write_results | Data        : None
     write_results | Report      : /cephfs/volumes/hpc_data_usr/k24087895/8bae1efe-9269-480e-9bb9-de76b8bdc9e7/final_project/metagenome_analysis/zymobiomics_folder/results/fastqc/pre_trimming/multiqc_report.html   (overwritten)
           multiqc | MultiQC complete
‚úÖ MultiQC report generated successfully.

Running Trimmomatic...
TrimmomaticPE: Started with arguments:
 -phred33 -threads 4 /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/raw_data///ZC1_S4_L001_R1_001.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/raw_data///ZC1_S4_L001_R2_001.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/paired/ZC1_S4_R1_paired.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/unpaired/ZC1_S4_R1_unpaired.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/paired/ZC1_S4_R2_paired.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/unpaired/ZC1_S4_R2_unpaired.fastq.gz ILLUMINACLIP:/scratch/users/k24087895/final_project/metagenome_analysis/data/adapters/zymobiomics_adaptors.fa:2:30:10:8:true HEADCROP:5 LEADING:5 CROP:240 SLIDINGWINDOW:4:15 TRAILING:10 MINLEN:30
Using Long Clipping Sequence: 'AGATCGGAAGAGCACACGTCTGAACTCCAGTCA'
Using Long Clipping Sequence: 'AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGT'
ILLUMINACLIP: Using 0 prefix pairs, 2 forward/reverse sequences, 0 forward only sequences, 0 reverse only sequences
Input Read Pairs: 327187 Both Surviving: 304355 (93.02%) Forward Only Surviving: 4716 (1.44%) Reverse Only Surviving: 861 (0.26%) Dropped: 17255 (5.27%)
TrimmomaticPE: Completed successfully
‚úÖ Trimmed ZC1_S4!

TrimmomaticPE: Started with arguments:
 -phred33 -threads 4 /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/raw_data///ZC2_S5_L001_R1_001.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/raw_data///ZC2_S5_L001_R2_001.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/paired/ZC2_S5_R1_paired.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/unpaired/ZC2_S5_R1_unpaired.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/paired/ZC2_S5_R2_paired.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/unpaired/ZC2_S5_R2_unpaired.fastq.gz ILLUMINACLIP:/scratch/users/k24087895/final_project/metagenome_analysis/data/adapters/zymobiomics_adaptors.fa:2:30:10:8:true HEADCROP:5 LEADING:5 CROP:240 SLIDINGWINDOW:4:15 TRAILING:10 MINLEN:30
Using Long Clipping Sequence: 'AGATCGGAAGAGCACACGTCTGAACTCCAGTCA'
Using Long Clipping Sequence: 'AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGT'
ILLUMINACLIP: Using 0 prefix pairs, 2 forward/reverse sequences, 0 forward only sequences, 0 reverse only sequences
Input Read Pairs: 331292 Both Surviving: 294099 (88.77%) Forward Only Surviving: 3707 (1.12%) Reverse Only Surviving: 976 (0.29%) Dropped: 32510 (9.81%)
TrimmomaticPE: Completed successfully
‚úÖ Trimmed ZC2_S5!

TrimmomaticPE: Started with arguments:
 -phred33 -threads 4 /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/raw_data///ZC3_S6_L001_R1_001.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/raw_data///ZC3_S6_L001_R2_001.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/paired/ZC3_S6_R1_paired.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/unpaired/ZC3_S6_R1_unpaired.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/paired/ZC3_S6_R2_paired.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/unpaired/ZC3_S6_R2_unpaired.fastq.gz ILLUMINACLIP:/scratch/users/k24087895/final_project/metagenome_analysis/data/adapters/zymobiomics_adaptors.fa:2:30:10:8:true HEADCROP:5 LEADING:5 CROP:240 SLIDINGWINDOW:4:15 TRAILING:10 MINLEN:30
Using Long Clipping Sequence: 'AGATCGGAAGAGCACACGTCTGAACTCCAGTCA'
Using Long Clipping Sequence: 'AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGT'
ILLUMINACLIP: Using 0 prefix pairs, 2 forward/reverse sequences, 0 forward only sequences, 0 reverse only sequences
Input Read Pairs: 328660 Both Surviving: 297186 (90.42%) Forward Only Surviving: 3675 (1.12%) Reverse Only Surviving: 964 (0.29%) Dropped: 26835 (8.16%)
TrimmomaticPE: Completed successfully
‚úÖ Trimmed ZC3_S6!

TrimmomaticPE: Started with arguments:
 -phred33 -threads 4 /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/raw_data///ZC4_S7_L001_R1_001.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/raw_data///ZC4_S7_L001_R2_001.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/paired/ZC4_S7_R1_paired.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/unpaired/ZC4_S7_R1_unpaired.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/paired/ZC4_S7_R2_paired.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/unpaired/ZC4_S7_R2_unpaired.fastq.gz ILLUMINACLIP:/scratch/users/k24087895/final_project/metagenome_analysis/data/adapters/zymobiomics_adaptors.fa:2:30:10:8:true HEADCROP:5 LEADING:5 CROP:240 SLIDINGWINDOW:4:15 TRAILING:10 MINLEN:30
Using Long Clipping Sequence: 'AGATCGGAAGAGCACACGTCTGAACTCCAGTCA'
Using Long Clipping Sequence: 'AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGT'
ILLUMINACLIP: Using 0 prefix pairs, 2 forward/reverse sequences, 0 forward only sequences, 0 reverse only sequences
Input Read Pairs: 298033 Both Surviving: 264207 (88.65%) Forward Only Surviving: 3299 (1.11%) Reverse Only Surviving: 900 (0.30%) Dropped: 29627 (9.94%)
TrimmomaticPE: Completed successfully
‚úÖ Trimmed ZC4_S7!

TrimmomaticPE: Started with arguments:
 -phred33 -threads 4 /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/raw_data///ZP1_S20_L001_R1_001.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/raw_data///ZP1_S20_L001_R2_001.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/paired/ZP1_S20_R1_paired.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/unpaired/ZP1_S20_R1_unpaired.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/paired/ZP1_S20_R2_paired.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/unpaired/ZP1_S20_R2_unpaired.fastq.gz ILLUMINACLIP:/scratch/users/k24087895/final_project/metagenome_analysis/data/adapters/zymobiomics_adaptors.fa:2:30:10:8:true HEADCROP:5 LEADING:5 CROP:240 SLIDINGWINDOW:4:15 TRAILING:10 MINLEN:30
Using Long Clipping Sequence: 'AGATCGGAAGAGCACACGTCTGAACTCCAGTCA'
Using Long Clipping Sequence: 'AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGT'
ILLUMINACLIP: Using 0 prefix pairs, 2 forward/reverse sequences, 0 forward only sequences, 0 reverse only sequences
Input Read Pairs: 349154 Both Surviving: 320066 (91.67%) Forward Only Surviving: 4721 (1.35%) Reverse Only Surviving: 991 (0.28%) Dropped: 23376 (6.70%)
TrimmomaticPE: Completed successfully
‚úÖ Trimmed ZP1_S20!

TrimmomaticPE: Started with arguments:
 -phred33 -threads 4 /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/raw_data///ZP2_S21_L001_R1_001.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/raw_data///ZP2_S21_L001_R2_001.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/paired/ZP2_S21_R1_paired.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/unpaired/ZP2_S21_R1_unpaired.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/paired/ZP2_S21_R2_paired.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/unpaired/ZP2_S21_R2_unpaired.fastq.gz ILLUMINACLIP:/scratch/users/k24087895/final_project/metagenome_analysis/data/adapters/zymobiomics_adaptors.fa:2:30:10:8:true HEADCROP:5 LEADING:5 CROP:240 SLIDINGWINDOW:4:15 TRAILING:10 MINLEN:30
Using Long Clipping Sequence: 'AGATCGGAAGAGCACACGTCTGAACTCCAGTCA'
Using Long Clipping Sequence: 'AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGT'
ILLUMINACLIP: Using 0 prefix pairs, 2 forward/reverse sequences, 0 forward only sequences, 0 reverse only sequences
Input Read Pairs: 358936 Both Surviving: 319710 (89.07%) Forward Only Surviving: 6569 (1.83%) Reverse Only Surviving: 1177 (0.33%) Dropped: 31480 (8.77%)
TrimmomaticPE: Completed successfully
‚úÖ Trimmed ZP2_S21!

TrimmomaticPE: Started with arguments:
 -phred33 -threads 4 /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/raw_data///ZP3_S22_L001_R1_001.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/raw_data///ZP3_S22_L001_R2_001.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/paired/ZP3_S22_R1_paired.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/unpaired/ZP3_S22_R1_unpaired.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/paired/ZP3_S22_R2_paired.fastq.gz /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/trimmed/unpaired/ZP3_S22_R2_unpaired.fastq.gz ILLUMINACLIP:/scratch/users/k24087895/final_project/metagenome_analysis/data/adapters/zymobiomics_adaptors.fa:2:30:10:8:true HEADCROP:5 LEADING:5 CROP:240 SLIDINGWINDOW:4:15 TRAILING:10 MINLEN:30
Using Long Clipping Sequence: 'AGATCGGAAGAGCACACGTCTGAACTCCAGTCA'
Using Long Clipping Sequence: 'AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGT'
ILLUMINACLIP: Using 0 prefix pairs, 2 forward/reverse sequences, 0 forward only sequences, 0 reverse only sequences
Input Read Pairs: 404941 Both Surviving: 359000 (88.65%) Forward Only Surviving: 3893 (0.96%) Reverse Only Surviving: 1197 (0.30%) Dropped: 40851 (10.09%)
TrimmomaticPE: Completed successfully
‚úÖ Trimmed ZP3_S22!


Running FastQC on paired trimmed reads...
‚úÖ FastQC completed successfully.

/// MultiQC üîç v1.27.1

     version_check | MultiQC Version v1.28 now available!
       file_search | Search path: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/fastqc/post_trimming

            fastqc | Found 14 reports

     write_results | Data        : None
     write_results | Report      : /cephfs/volumes/hpc_data_usr/k24087895/8bae1efe-9269-480e-9bb9-de76b8bdc9e7/final_project/metagenome_analysis/zymobiomics_folder/results/fastqc/post_trimming/multiqc_report.html   (overwritten)
           multiqc | MultiQC complete
‚úÖ MultiQC report generated successfully.


================================================= METAGENOMIC ABUNDANCE ESTIMATION =================================================
‚ö†Ô∏è This step assumes reads have already been trimmed with Trimmomatic and host DNA removed with Bowtie2. Processed reads must be in the correct directory.

Processing sample: ZC1_S4

Removing human reads with Bowtie2...
304355 reads; of these:
  304355 (100.00%) were paired; of these:
    304354 (100.00%) aligned concordantly 0 times
    0 (0.00%) aligned concordantly exactly 1 time
    1 (0.00%) aligned concordantly >1 times
0.00% overall alignment rate
‚úÖ Host reads removed and filtered reads compressed.

Classifying metagenomic reads with Kraken2...
kraken2 --db "/scratch/users/k24087895/final_project/metagenome_analysis/data/databases/k2_standard_16gb_20241228" --threads 8 --report "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZC1_S4.k2report"                --report-minimizer-data --paired --minimum-hit-groups 2 --gzip-compressed                --classified-out "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/classified/ZC1_S4_classified#.fastq" --unclassified-out "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/unclassified/ZC1_S4_unclassified#.fastq"                "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/filtered_fastq/ZC1_S4_metagenomic.1.gz" "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/filtered_fastq/ZC1_S4_metagenomic.2.gz"                --output "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/kraken2/ZC1_S4.kraken2" --use-names 2>&1
Loading database information... done.
304354 sequences (53.05 Mbp) processed in 1.722s (10607.3 Kseq/m, 1848.84 Mbp/m).
  214302 sequences classified (70.41%)
  90052 sequences unclassified (29.59%)
‚úÖ Classification complete.

Estimating species abundance with Bracken...
 >> Checking for Valid Options...
 >> Running Bracken 
      >> python src/est_abundance.py -i /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZC1_S4.k2report -o /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/bracken/ZC1_S4.bracken -k /scratch/users/k24087895/final_project/metagenome_analysis/data/databases/k2_standard_16gb_20241228/database100mers.kmer_distrib -l S -t 10
>> Checking report file: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZC1_S4.k2report
PROGRAM START TIME: 03-26-2025 12:03:45
BRACKEN SUMMARY (Kraken report: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZC1_S4.k2report)
    >>> Threshold: 10 
    >>> Number of species in sample: 291 
	  >> Number of species with reads > threshold: 36 
	  >> Number of species with reads < threshold: 255 
    >>> Total reads in sample: 304354
	  >> Total reads kept at species level (reads > threshold): 63509
	  >> Total reads discarded (species reads < threshold): 348
	  >> Reads distributed: 150368
	  >> Reads not distributed (eg. no species above threshold): 77
	  >> Unclassified reads: 90052
BRACKEN OUTPUT PRODUCED: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/bracken/ZC1_S4.bracken
PROGRAM END TIME: 03-26-2025 12:03:45
  Bracken complete.
‚úÖ Abundance estimated.

Generating Krona visualization...
Writing /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/krona/ZC1_S4.krona.html...
‚úÖ Krona plot generated.

Processing sample: ZC2_S5

Removing human reads with Bowtie2...
294099 reads; of these:
  294099 (100.00%) were paired; of these:
    294096 (100.00%) aligned concordantly 0 times
    0 (0.00%) aligned concordantly exactly 1 time
    3 (0.00%) aligned concordantly >1 times
0.00% overall alignment rate
‚úÖ Host reads removed and filtered reads compressed.

Classifying metagenomic reads with Kraken2...
kraken2 --db "/scratch/users/k24087895/final_project/metagenome_analysis/data/databases/k2_standard_16gb_20241228" --threads 8 --report "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZC2_S5.k2report"                --report-minimizer-data --paired --minimum-hit-groups 2 --gzip-compressed                --classified-out "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/classified/ZC2_S5_classified#.fastq" --unclassified-out "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/unclassified/ZC2_S5_unclassified#.fastq"                "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/filtered_fastq/ZC2_S5_metagenomic.1.gz" "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/filtered_fastq/ZC2_S5_metagenomic.2.gz"                --output "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/kraken2/ZC2_S5.kraken2" --use-names 2>&1
Loading database information... done.
294096 sequences (40.22 Mbp) processed in 2.162s (8163.3 Kseq/m, 1116.30 Mbp/m).
  174763 sequences classified (59.42%)
  119333 sequences unclassified (40.58%)
‚úÖ Classification complete.

Estimating species abundance with Bracken...
 >> Checking for Valid Options...
 >> Running Bracken 
      >> python src/est_abundance.py -i /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZC2_S5.k2report -o /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/bracken/ZC2_S5.bracken -k /scratch/users/k24087895/final_project/metagenome_analysis/data/databases/k2_standard_16gb_20241228/database100mers.kmer_distrib -l S -t 10
>> Checking report file: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZC2_S5.k2report
PROGRAM START TIME: 03-26-2025 12:04:29
BRACKEN SUMMARY (Kraken report: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZC2_S5.k2report)
    >>> Threshold: 10 
    >>> Number of species in sample: 254 
	  >> Number of species with reads > threshold: 27 
	  >> Number of species with reads < threshold: 227 
    >>> Total reads in sample: 294096
	  >> Total reads kept at species level (reads > threshold): 45443
	  >> Total reads discarded (species reads < threshold): 349
	  >> Reads distributed: 128896
	  >> Reads not distributed (eg. no species above threshold): 75
	  >> Unclassified reads: 119333
BRACKEN OUTPUT PRODUCED: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/bracken/ZC2_S5.bracken
PROGRAM END TIME: 03-26-2025 12:04:29
  Bracken complete.
‚úÖ Abundance estimated.

Generating Krona visualization...
Writing /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/krona/ZC2_S5.krona.html...
‚úÖ Krona plot generated.

Processing sample: ZC3_S6

Removing human reads with Bowtie2...
297186 reads; of these:
  297186 (100.00%) were paired; of these:
    297184 (100.00%) aligned concordantly 0 times
    1 (0.00%) aligned concordantly exactly 1 time
    1 (0.00%) aligned concordantly >1 times
0.00% overall alignment rate
‚úÖ Host reads removed and filtered reads compressed.

Classifying metagenomic reads with Kraken2...
kraken2 --db "/scratch/users/k24087895/final_project/metagenome_analysis/data/databases/k2_standard_16gb_20241228" --threads 8 --report "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZC3_S6.k2report"                --report-minimizer-data --paired --minimum-hit-groups 2 --gzip-compressed                --classified-out "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/classified/ZC3_S6_classified#.fastq" --unclassified-out "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/unclassified/ZC3_S6_unclassified#.fastq"                "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/filtered_fastq/ZC3_S6_metagenomic.1.gz" "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/filtered_fastq/ZC3_S6_metagenomic.2.gz"                --output "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/kraken2/ZC3_S6.kraken2" --use-names 2>&1
Loading database information... done.
297184 sequences (44.56 Mbp) processed in 1.539s (11586.6 Kseq/m, 1737.35 Mbp/m).
  185501 sequences classified (62.42%)
  111683 sequences unclassified (37.58%)
‚úÖ Classification complete.

Estimating species abundance with Bracken...
 >> Checking for Valid Options...
 >> Running Bracken 
      >> python src/est_abundance.py -i /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZC3_S6.k2report -o /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/bracken/ZC3_S6.bracken -k /scratch/users/k24087895/final_project/metagenome_analysis/data/databases/k2_standard_16gb_20241228/database100mers.kmer_distrib -l S -t 10
>> Checking report file: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZC3_S6.k2report
PROGRAM START TIME: 03-26-2025 12:05:15
BRACKEN SUMMARY (Kraken report: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZC3_S6.k2report)
    >>> Threshold: 10 
    >>> Number of species in sample: 252 
	  >> Number of species with reads > threshold: 31 
	  >> Number of species with reads < threshold: 221 
    >>> Total reads in sample: 297184
	  >> Total reads kept at species level (reads > threshold): 53007
	  >> Total reads discarded (species reads < threshold): 348
	  >> Reads distributed: 132070
	  >> Reads not distributed (eg. no species above threshold): 76
	  >> Unclassified reads: 111683
BRACKEN OUTPUT PRODUCED: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/bracken/ZC3_S6.bracken
PROGRAM END TIME: 03-26-2025 12:05:15
  Bracken complete.
‚úÖ Abundance estimated.

Generating Krona visualization...
Writing /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/krona/ZC3_S6.krona.html...
‚úÖ Krona plot generated.

Processing sample: ZC4_S7

Removing human reads with Bowtie2...
264207 reads; of these:
  264207 (100.00%) were paired; of these:
    264206 (100.00%) aligned concordantly 0 times
    0 (0.00%) aligned concordantly exactly 1 time
    1 (0.00%) aligned concordantly >1 times
0.00% overall alignment rate
‚úÖ Host reads removed and filtered reads compressed.

Classifying metagenomic reads with Kraken2...
kraken2 --db "/scratch/users/k24087895/final_project/metagenome_analysis/data/databases/k2_standard_16gb_20241228" --threads 8 --report "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZC4_S7.k2report"                --report-minimizer-data --paired --minimum-hit-groups 2 --gzip-compressed                --classified-out "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/classified/ZC4_S7_classified#.fastq" --unclassified-out "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/unclassified/ZC4_S7_unclassified#.fastq"                "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/filtered_fastq/ZC4_S7_metagenomic.1.gz" "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/filtered_fastq/ZC4_S7_metagenomic.2.gz"                --output "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/kraken2/ZC4_S7.kraken2" --use-names 2>&1
Loading database information... done.
264206 sequences (36.78 Mbp) processed in 1.371s (11564.0 Kseq/m, 1609.67 Mbp/m).
  154559 sequences classified (58.50%)
  109647 sequences unclassified (41.50%)
‚úÖ Classification complete.

Estimating species abundance with Bracken...
 >> Checking for Valid Options...
 >> Running Bracken 
      >> python src/est_abundance.py -i /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZC4_S7.k2report -o /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/bracken/ZC4_S7.bracken -k /scratch/users/k24087895/final_project/metagenome_analysis/data/databases/k2_standard_16gb_20241228/database100mers.kmer_distrib -l S -t 10
>> Checking report file: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZC4_S7.k2report
PROGRAM START TIME: 03-26-2025 12:06:00
BRACKEN SUMMARY (Kraken report: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZC4_S7.k2report)
    >>> Threshold: 10 
    >>> Number of species in sample: 195 
	  >> Number of species with reads > threshold: 25 
	  >> Number of species with reads < threshold: 170 
    >>> Total reads in sample: 264206
	  >> Total reads kept at species level (reads > threshold): 44537
	  >> Total reads discarded (species reads < threshold): 281
	  >> Reads distributed: 109685
	  >> Reads not distributed (eg. no species above threshold): 56
	  >> Unclassified reads: 109647
BRACKEN OUTPUT PRODUCED: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/bracken/ZC4_S7.bracken
PROGRAM END TIME: 03-26-2025 12:06:00
  Bracken complete.
‚úÖ Abundance estimated.

Generating Krona visualization...
Writing /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/krona/ZC4_S7.krona.html...
‚úÖ Krona plot generated.

Processing sample: ZP1_S20

Removing human reads with Bowtie2...
320066 reads; of these:
  320066 (100.00%) were paired; of these:
    320064 (100.00%) aligned concordantly 0 times
    0 (0.00%) aligned concordantly exactly 1 time
    2 (0.00%) aligned concordantly >1 times
0.00% overall alignment rate
‚úÖ Host reads removed and filtered reads compressed.

Classifying metagenomic reads with Kraken2...
kraken2 --db "/scratch/users/k24087895/final_project/metagenome_analysis/data/databases/k2_standard_16gb_20241228" --threads 8 --report "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZP1_S20.k2report"                --report-minimizer-data --paired --minimum-hit-groups 2 --gzip-compressed                --classified-out "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/classified/ZP1_S20_classified#.fastq" --unclassified-out "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/unclassified/ZP1_S20_unclassified#.fastq"                "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/filtered_fastq/ZP1_S20_metagenomic.1.gz" "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/filtered_fastq/ZP1_S20_metagenomic.2.gz"                --output "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/kraken2/ZP1_S20.kraken2" --use-names 2>&1
Loading database information... done.
320064 sequences (48.30 Mbp) processed in 1.619s (11862.9 Kseq/m, 1790.09 Mbp/m).
  213679 sequences classified (66.76%)
  106385 sequences unclassified (33.24%)
‚úÖ Classification complete.

Estimating species abundance with Bracken...
 >> Checking for Valid Options...
 >> Running Bracken 
      >> python src/est_abundance.py -i /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZP1_S20.k2report -o /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/bracken/ZP1_S20.bracken -k /scratch/users/k24087895/final_project/metagenome_analysis/data/databases/k2_standard_16gb_20241228/database100mers.kmer_distrib -l S -t 10
>> Checking report file: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZP1_S20.k2report
PROGRAM START TIME: 03-26-2025 12:06:51
BRACKEN SUMMARY (Kraken report: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZP1_S20.k2report)
    >>> Threshold: 10 
    >>> Number of species in sample: 264 
	  >> Number of species with reads > threshold: 31 
	  >> Number of species with reads < threshold: 233 
    >>> Total reads in sample: 320064
	  >> Total reads kept at species level (reads > threshold): 61479
	  >> Total reads discarded (species reads < threshold): 342
	  >> Reads distributed: 151787
	  >> Reads not distributed (eg. no species above threshold): 71
	  >> Unclassified reads: 106385
BRACKEN OUTPUT PRODUCED: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/bracken/ZP1_S20.bracken
PROGRAM END TIME: 03-26-2025 12:06:51
  Bracken complete.
‚úÖ Abundance estimated.

Generating Krona visualization...
Writing /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/krona/ZP1_S20.krona.html...
‚úÖ Krona plot generated.

Processing sample: ZP2_S21

Removing human reads with Bowtie2...
319710 reads; of these:
  319710 (100.00%) were paired; of these:
    319707 (100.00%) aligned concordantly 0 times
    0 (0.00%) aligned concordantly exactly 1 time
    3 (0.00%) aligned concordantly >1 times
0.00% overall alignment rate
‚úÖ Host reads removed and filtered reads compressed.

Classifying metagenomic reads with Kraken2...
kraken2 --db "/scratch/users/k24087895/final_project/metagenome_analysis/data/databases/k2_standard_16gb_20241228" --threads 8 --report "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZP2_S21.k2report"                --report-minimizer-data --paired --minimum-hit-groups 2 --gzip-compressed                --classified-out "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/classified/ZP2_S21_classified#.fastq" --unclassified-out "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/unclassified/ZP2_S21_unclassified#.fastq"                "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/filtered_fastq/ZP2_S21_metagenomic.1.gz" "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/filtered_fastq/ZP2_S21_metagenomic.2.gz"                --output "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/kraken2/ZP2_S21.kraken2" --use-names 2>&1
Loading database information... done.
319707 sequences (44.89 Mbp) processed in 1.733s (11070.9 Kseq/m, 1554.63 Mbp/m).
  198224 sequences classified (62.00%)
  121483 sequences unclassified (38.00%)
‚úÖ Classification complete.

Estimating species abundance with Bracken...
 >> Checking for Valid Options...
 >> Running Bracken 
      >> python src/est_abundance.py -i /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZP2_S21.k2report -o /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/bracken/ZP2_S21.bracken -k /scratch/users/k24087895/final_project/metagenome_analysis/data/databases/k2_standard_16gb_20241228/database100mers.kmer_distrib -l S -t 10
>> Checking report file: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZP2_S21.k2report
PROGRAM START TIME: 03-26-2025 12:07:36
BRACKEN SUMMARY (Kraken report: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZP2_S21.k2report)
    >>> Threshold: 10 
    >>> Number of species in sample: 244 
	  >> Number of species with reads > threshold: 27 
	  >> Number of species with reads < threshold: 217 
    >>> Total reads in sample: 319707
	  >> Total reads kept at species level (reads > threshold): 55769
	  >> Total reads discarded (species reads < threshold): 384
	  >> Reads distributed: 142007
	  >> Reads not distributed (eg. no species above threshold): 64
	  >> Unclassified reads: 121483
BRACKEN OUTPUT PRODUCED: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/bracken/ZP2_S21.bracken
PROGRAM END TIME: 03-26-2025 12:07:36
  Bracken complete.
‚úÖ Abundance estimated.

Generating Krona visualization...
Writing /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/krona/ZP2_S21.krona.html...
‚úÖ Krona plot generated.

Processing sample: ZP3_S22

Removing human reads with Bowtie2...
359000 reads; of these:
  359000 (100.00%) were paired; of these:
    358997 (100.00%) aligned concordantly 0 times
    2 (0.00%) aligned concordantly exactly 1 time
    1 (0.00%) aligned concordantly >1 times
0.00% overall alignment rate
‚úÖ Host reads removed and filtered reads compressed.

Classifying metagenomic reads with Kraken2...
kraken2 --db "/scratch/users/k24087895/final_project/metagenome_analysis/data/databases/k2_standard_16gb_20241228" --threads 8 --report "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZP3_S22.k2report"                --report-minimizer-data --paired --minimum-hit-groups 2 --gzip-compressed                --classified-out "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/classified/ZP3_S22_classified#.fastq" --unclassified-out "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/unclassified/ZP3_S22_unclassified#.fastq"                "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/filtered_fastq/ZP3_S22_metagenomic.1.gz" "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/filtered_fastq/ZP3_S22_metagenomic.2.gz"                --output "/scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/kraken2/ZP3_S22.kraken2" --use-names 2>&1
Loading database information... done.
358997 sequences (49.29 Mbp) processed in 1.828s (11782.4 Kseq/m, 1617.76 Mbp/m).
  217911 sequences classified (60.70%)
  141086 sequences unclassified (39.30%)
‚úÖ Classification complete.

Estimating species abundance with Bracken...
 >> Checking for Valid Options...
 >> Running Bracken 
      >> python src/est_abundance.py -i /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZP3_S22.k2report -o /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/bracken/ZP3_S22.bracken -k /scratch/users/k24087895/final_project/metagenome_analysis/data/databases/k2_standard_16gb_20241228/database100mers.kmer_distrib -l S -t 10
>> Checking report file: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZP3_S22.k2report
PROGRAM START TIME: 03-26-2025 12:08:29
BRACKEN SUMMARY (Kraken report: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/reports/ZP3_S22.k2report)
    >>> Threshold: 10 
    >>> Number of species in sample: 240 
	  >> Number of species with reads > threshold: 27 
	  >> Number of species with reads < threshold: 213 
    >>> Total reads in sample: 358997
	  >> Total reads kept at species level (reads > threshold): 61002
	  >> Total reads discarded (species reads < threshold): 360
	  >> Reads distributed: 156480
	  >> Reads not distributed (eg. no species above threshold): 69
	  >> Unclassified reads: 141086
BRACKEN OUTPUT PRODUCED: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/bracken/ZP3_S22.bracken
PROGRAM END TIME: 03-26-2025 12:08:29
  Bracken complete.
‚úÖ Abundance estimated.

Generating Krona visualization...
Writing /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/krona/ZP3_S22.krona.html...
‚úÖ Krona plot generated.

Metagenomic classification completed in: 00:05:37

================================================= METAGENOMIC DIVERSITY ANALYSIS =================================================
Calculating alpha and beta diversity...
‚úÖ Alpha diversity calculated for all samples.
null device 
          1 
Heatmap saved to: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/runs/run_2603_1200/diversity/beta_diversity_heatmap.png 
‚úÖ Beta diversity heatmap generated.

==================================================== TOTAL READ EXTRACTION ====================================================
‚úÖ Total read counts saved to: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/processed_data/metagenomic/total_reads.csv

====================================================== HUMAN DNA ANALYSIS ======================================================

Processing host reads from sample: ZC1_S4
‚úÖ BAM sorted.
‚úÖ BAM indexed.
‚úÖ BED created.

Processing host reads from sample: ZC2_S5
‚úÖ BAM sorted.
‚úÖ BAM indexed.
‚úÖ BED created.

Processing host reads from sample: ZC3_S6
‚úÖ BAM sorted.
‚úÖ BAM indexed.
‚úÖ BED created.

Processing host reads from sample: ZC4_S7
‚úÖ BAM sorted.
‚úÖ BAM indexed.
‚úÖ BED created.

Processing host reads from sample: ZP1_S20
‚úÖ BAM sorted.
‚úÖ BAM indexed.
‚úÖ BED created.

Processing host reads from sample: ZP2_S21
‚úÖ BAM sorted.
‚úÖ BAM indexed.
‚úÖ BED created.

Processing host reads from sample: ZP3_S22
‚úÖ BAM sorted.
‚úÖ BAM indexed.
‚úÖ BED created.

=============================================== KARYOTYPE ================================================
Identifying overlapping regions across samples...
Generating karyotype plot...
null device 
          1 
‚úÖ Karyotype plot generated.

================================================== BLAST ==================================================

Extracting sequences for BLAST query...
‚úÖ Sequences saved to BLAST query.
‚ùå No regions found. Skipping BLAST.

=========================================== JACCARD SIMILARITY ===========================================
Generating Jaccard similarity heatmap...
null device 
          1 
Heatmap saved at: /scratch/users/k24087895/final_project/metagenome_analysis/zymobiomics_folder/results/host_dna_analysis/jaccard_similarity_heatmap.png 
‚úÖ Jaccard analysis complete.

‚úÖ Pipeline completed successfully.
