
================================================= CONDA ENVIRONMENT ACTIVATION ==================================================
✅ 'final_project' environment activated successfully.

================================================= ARGUMENT PARSING & VALIDATION =================================================
Raw FASTQ directory path: /scratch/users/k24087895/final_project/zymobiomics_folder/raw_data/

======================================================= PIPELINE SUMMARY ========================================================
Quality Control & Trimming: Disabled ❌
⚠️ Optional, but must be done at least once on the raw reads for the pipeline to work.

Host DNA Removal: Disabled ❌
⚠️ Optional, but must be done at least once on the trimmed reads for the pipeline to work.

Kraken2/Bracken Database: /scratch/users/k24087895/final_project/data/databases/k2_standard_16gb_20241228
=================================================================================================================================

====================================================== PROJECT STRUCTURE ======================================================
Results are in /scratch/users/k24087895/final_project/zymobiomics_folder/results (FastQC: /scratch/users/k24087895/final_project/zymobiomics_folder/results/fastqc, Host DNA: /scratch/users/k24087895/final_project/zymobiomics_folder/results/host_dna_analysis).
/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/human
├── aligned_sam
├── bed_files
└── sorted_bam

3 directories
Human DNA-related files (SAM, BAM, and BED) in HUMAN_DIR are created once per sub-project and do not change with each pipeline run.
Intermediate metagenomic files in /scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic are generated and overwritten with each pipeline execution and should be inspected beforehand if desired.
Run-specific results (e.g., Kraken2, Bracken) are in /scratch/users/k24087895/final_project/zymobiomics_folder/results/runs/run_0504_1736.
✅ All output directories created successfully.

================================================= METAGENOMIC ABUNDANCE ESTIMATION =================================================
⚠️ This step assumes reads have already been trimmed with Trimmomatic and host DNA removed with Bowtie2. Processed reads must be in the correct directory.

Processing sample: ZC1_S4

Classifying metagenomic reads with Kraken2...
kraken2 --db "/scratch/users/k24087895/final_project/data/databases/k2_standard_16gb_20241228" --threads 8 --report "/scratch/users/k24087895/final_project/zymobiomics_folder/results/runs/run_0504_1736/reports/ZC1_S4.k2report"                --report-minimizer-data --paired --minimum-hit-groups 2 --gzip-compressed                --classified-out "/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/classified/ZC1_S4_classified#.fastq" --unclassified-out "/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/unclassified/ZC1_S4_unclassified#.fastq"                "/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/filtered_fastq/ZC1_S4_metagenomic.1.gz" "/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/filtered_fastq/ZC1_S4_metagenomic.2.gz"                --output "/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/kraken2/ZC1_S4.kraken2" --use-names 2>&1
Loading database information... done.
287718 sequences (51.94 Mbp) processed in 1.496s (11540.7 Kseq/m, 2083.26 Mbp/m).
  213967 sequences classified (74.37%)
  73751 sequences unclassified (25.63%)
✅ Classification complete.

Estimating species abundance with Bracken...
 >> Checking for Valid Options...
 >> Running Bracken 
      >> python src/est_abundance.py -i /scratch/users/k24087895/final_project/zymobiomics_folder/results/runs/run_0504_1736/reports/ZC1_S4.k2report -o /scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/bracken/ZC1_S4.bracken -k /scratch/users/k24087895/final_project/data/databases/k2_standard_16gb_20241228/database100mers.kmer_distrib -l S -t 10
>> Checking report file: /scratch/users/k24087895/final_project/zymobiomics_folder/results/runs/run_0504_1736/reports/ZC1_S4.k2report
PROGRAM START TIME: 04-05-2025 16:36:47
BRACKEN SUMMARY (Kraken report: /scratch/users/k24087895/final_project/zymobiomics_folder/results/runs/run_0504_1736/reports/ZC1_S4.k2report)
    >>> Threshold: 10 
    >>> Number of species in sample: 290 
	  >> Number of species with reads > threshold: 36 
	  >> Number of species with reads < threshold: 254 
    >>> Total reads in sample: 287718
	  >> Total reads kept at species level (reads > threshold): 63408
	  >> Total reads discarded (species reads < threshold): 346
	  >> Reads distributed: 150136
	  >> Reads not distributed (eg. no species above threshold): 77
	  >> Unclassified reads: 73751
BRACKEN OUTPUT PRODUCED: /scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/bracken/ZC1_S4.bracken
PROGRAM END TIME: 04-05-2025 16:36:47
  Bracken complete.
✅ Abundance estimated.

Generating Krona visualization...
Writing /scratch/users/k24087895/final_project/zymobiomics_folder/results/runs/run_0504_1736/krona/ZC1_S4.krona.html...
✅ Krona plot generated.

Processing sample: ZC2_S5

Classifying metagenomic reads with Kraken2...
kraken2 --db "/scratch/users/k24087895/final_project/data/databases/k2_standard_16gb_20241228" --threads 8 --report "/scratch/users/k24087895/final_project/zymobiomics_folder/results/runs/run_0504_1736/reports/ZC2_S5.k2report"                --report-minimizer-data --paired --minimum-hit-groups 2 --gzip-compressed                --classified-out "/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/classified/ZC2_S5_classified#.fastq" --unclassified-out "/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/unclassified/ZC2_S5_unclassified#.fastq"                "/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/filtered_fastq/ZC2_S5_metagenomic.1.gz" "/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/filtered_fastq/ZC2_S5_metagenomic.2.gz"                --output "/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/kraken2/ZC2_S5.kraken2" --use-names 2>&1
Loading database information... done.
267587 sequences (38.48 Mbp) processed in 1.103s (14552.5 Kseq/m, 2092.72 Mbp/m).
  174544 sequences classified (65.23%)
  93043 sequences unclassified (34.77%)
✅ Classification complete.

Estimating species abundance with Bracken...
 >> Checking for Valid Options...
 >> Running Bracken 
      >> python src/est_abundance.py -i /scratch/users/k24087895/final_project/zymobiomics_folder/results/runs/run_0504_1736/reports/ZC2_S5.k2report -o /scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/bracken/ZC2_S5.bracken -k /scratch/users/k24087895/final_project/data/databases/k2_standard_16gb_20241228/database100mers.kmer_distrib -l S -t 10
>> Checking report file: /scratch/users/k24087895/final_project/zymobiomics_folder/results/runs/run_0504_1736/reports/ZC2_S5.k2report
PROGRAM START TIME: 04-05-2025 16:36:59
BRACKEN SUMMARY (Kraken report: /scratch/users/k24087895/final_project/zymobiomics_folder/results/runs/run_0504_1736/reports/ZC2_S5.k2report)
    >>> Threshold: 10 
    >>> Number of species in sample: 254 
	  >> Number of species with reads > threshold: 27 
	  >> Number of species with reads < threshold: 227 
    >>> Total reads in sample: 267587
	  >> Total reads kept at species level (reads > threshold): 45387
	  >> Total reads discarded (species reads < threshold): 349
	  >> Reads distributed: 128733
	  >> Reads not distributed (eg. no species above threshold): 75
	  >> Unclassified reads: 93043
BRACKEN OUTPUT PRODUCED: /scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/bracken/ZC2_S5.bracken
PROGRAM END TIME: 04-05-2025 16:36:59
  Bracken complete.
✅ Abundance estimated.

Generating Krona visualization...
Writing /scratch/users/k24087895/final_project/zymobiomics_folder/results/runs/run_0504_1736/krona/ZC2_S5.krona.html...
✅ Krona plot generated.

Processing sample: ZC3_S6

Classifying metagenomic reads with Kraken2...
kraken2 --db "/scratch/users/k24087895/final_project/data/databases/k2_standard_16gb_20241228" --threads 8 --report "/scratch/users/k24087895/final_project/zymobiomics_folder/results/runs/run_0504_1736/reports/ZC3_S6.k2report"                --report-minimizer-data --paired --minimum-hit-groups 2 --gzip-compressed                --classified-out "/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/classified/ZC3_S6_classified#.fastq" --unclassified-out "/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/unclassified/ZC3_S6_unclassified#.fastq"                "/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/filtered_fastq/ZC3_S6_metagenomic.1.gz" "/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/filtered_fastq/ZC3_S6_metagenomic.2.gz"                --output "/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/kraken2/ZC3_S6.kraken2" --use-names 2>&1
Loading database information... done.
273957 sequences (43.03 Mbp) processed in 1.308s (12565.7 Kseq/m, 1973.83 Mbp/m).
  185233 sequences classified (67.61%)
  88724 sequences unclassified (32.39%)
✅ Classification complete.

Estimating species abundance with Bracken...
 >> Checking for Valid Options...
 >> Running Bracken 
      >> python src/est_abundance.py -i /scratch/users/k24087895/final_project/zymobiomics_folder/results/runs/run_0504_1736/reports/ZC3_S6.k2report -o /scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/bracken/ZC3_S6.bracken -k /scratch/users/k24087895/final_project/data/databases/k2_standard_16gb_20241228/database100mers.kmer_distrib -l S -t 10
>> Checking report file: /scratch/users/k24087895/final_project/zymobiomics_folder/results/runs/run_0504_1736/reports/ZC3_S6.k2report
PROGRAM START TIME: 04-05-2025 16:37:11
BRACKEN SUMMARY (Kraken report: /scratch/users/k24087895/final_project/zymobiomics_folder/results/runs/run_0504_1736/reports/ZC3_S6.k2report)
    >>> Threshold: 10 
    >>> Number of species in sample: 252 
	  >> Number of species with reads > threshold: 31 
	  >> Number of species with reads < threshold: 221 
    >>> Total reads in sample: 273957
	  >> Total reads kept at species level (reads > threshold): 52928
	  >> Total reads discarded (species reads < threshold): 347
	  >> Reads distributed: 131882
	  >> Reads not distributed (eg. no species above threshold): 76
	  >> Unclassified reads: 88724
BRACKEN OUTPUT PRODUCED: /scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/bracken/ZC3_S6.bracken
PROGRAM END TIME: 04-05-2025 16:37:11
  Bracken complete.
✅ Abundance estimated.

Generating Krona visualization...
Writing /scratch/users/k24087895/final_project/zymobiomics_folder/results/runs/run_0504_1736/krona/ZC3_S6.krona.html...
✅ Krona plot generated.

Processing sample: ZC4_S7

Classifying metagenomic reads with Kraken2...
kraken2 --db "/scratch/users/k24087895/final_project/data/databases/k2_standard_16gb_20241228" --threads 8 --report "/scratch/users/k24087895/final_project/zymobiomics_folder/results/runs/run_0504_1736/reports/ZC4_S7.k2report"                --report-minimizer-data --paired --minimum-hit-groups 2 --gzip-compressed                --classified-out "/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/classified/ZC4_S7_classified#.fastq" --unclassified-out "/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/unclassified/ZC4_S7_unclassified#.fastq"                "/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/filtered_fastq/ZC4_S7_metagenomic.1.gz" "/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/filtered_fastq/ZC4_S7_metagenomic.2.gz"                --output "/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/kraken2/ZC4_S7.kraken2" --use-names 2>&1
Loading database information... done.
238889 sequences (35.12 Mbp) processed in 1.165s (12306.8 Kseq/m, 1809.06 Mbp/m).
  154353 sequences classified (64.61%)
  84536 sequences unclassified (35.39%)
✅ Classification complete.

Estimating species abundance with Bracken...
 >> Checking for Valid Options...
 >> Running Bracken 
      >> python src/est_abundance.py -i /scratch/users/k24087895/final_project/zymobiomics_folder/results/runs/run_0504_1736/reports/ZC4_S7.k2report -o /scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/bracken/ZC4_S7.bracken -k /scratch/users/k24087895/final_project/data/databases/k2_standard_16gb_20241228/database100mers.kmer_distrib -l S -t 10
>> Checking report file: /scratch/users/k24087895/final_project/zymobiomics_folder/results/runs/run_0504_1736/reports/ZC4_S7.k2report
PROGRAM START TIME: 04-05-2025 16:37:24
BRACKEN SUMMARY (Kraken report: /scratch/users/k24087895/final_project/zymobiomics_folder/results/runs/run_0504_1736/reports/ZC4_S7.k2report)
    >>> Threshold: 10 
    >>> Number of species in sample: 195 
	  >> Number of species with reads > threshold: 25 
	  >> Number of species with reads < threshold: 170 
    >>> Total reads in sample: 238889
	  >> Total reads kept at species level (reads > threshold): 44472
	  >> Total reads discarded (species reads < threshold): 281
	  >> Reads distributed: 109545
	  >> Reads not distributed (eg. no species above threshold): 55
	  >> Unclassified reads: 84536
BRACKEN OUTPUT PRODUCED: /scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/bracken/ZC4_S7.bracken
PROGRAM END TIME: 04-05-2025 16:37:24
  Bracken complete.
✅ Abundance estimated.

Generating Krona visualization...
Writing /scratch/users/k24087895/final_project/zymobiomics_folder/results/runs/run_0504_1736/krona/ZC4_S7.krona.html...
✅ Krona plot generated.

Processing sample: ZP1_S20

Classifying metagenomic reads with Kraken2...
kraken2 --db "/scratch/users/k24087895/final_project/data/databases/k2_standard_16gb_20241228" --threads 8 --report "/scratch/users/k24087895/final_project/zymobiomics_folder/results/runs/run_0504_1736/reports/ZP1_S20.k2report"                --report-minimizer-data --paired --minimum-hit-groups 2 --gzip-compressed                --classified-out "/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/classified/ZP1_S20_classified#.fastq" --unclassified-out "/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/unclassified/ZP1_S20_unclassified#.fastq"                "/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/filtered_fastq/ZP1_S20_metagenomic.1.gz" "/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/filtered_fastq/ZP1_S20_metagenomic.2.gz"                --output "/scratch/users/k24087895/final_project/zymobiomics_folder/processed_data/metagenomic/kraken2/ZP1_S20.kraken2" --use-names 2>&1
Loading database information... done.
